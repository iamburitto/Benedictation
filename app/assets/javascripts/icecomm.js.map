{"version":3,"sources":["icecomm.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","getUserMedia","RTCMediaStream","navigator","mozGetUserMedia","bind","MediaStream","webkitGetUserMedia","webkitMediaStream","RTCSessionDescription","window","mozRTCSessionDescription","RTCPeerConnection","mozRTCPeerConnection","webkitRTCPeerConnection","RTCIceCandidate","mozRTCIceCandidate",2,"Icecomm","console","log","./main",3,"io","APIKEY","appSettings","createRoomSettings","settings","roomSettings","stream","constraints","video","audio","limit","checkSettingsBeforeCall","localStream","ended","joinRoom","gotStreamSuccess","errorHandler","roomInfo","room","currentRoom","apiKey","roomLimit","socket","emit","answerEvent","callerID","remoteDescription","printDebugMessage","answer","localPeerConnections","channel","setRemoteDescription","offerEvent","serverInfo","createPeerConnections","addStream","offer","createAnswer","localDescription","sdp","parseSDP","createDescription","options","createStreamOptions","trigger","createOffer","description","isCaller","optionalRtpDataChannels","dataChannels","createDataChannel","reliable","createDataChannels","onicecandidate","event","iceCandidateHandler","candidate","onaddstream","addRemoteStream","onnegotiationneeded","negotiationNeededHandler","ondatachannel","onerror","onmessage","messageDataHandler","data","onopen","openDataHandler","onclose","closeDataHandler","remoteStreams","JSON","parse","isReady","pendingData","send","offerOrAnswer","descriptionObj","from","myID","to","setLocalDescription","candidateObj","label","sdpMLineIndex","err","eventsObj","onLeftHandler","removePeer","localOrRemote","ID","browserType","audiolessStream","getVideoTracks","URL","createObjectURL","rawStream","createVideoElement","tempVideo","document","createElement","src","id","autoplay","close","undefined","message","debugMode","checkDebugMode","debug","differenceInDomain","oldDomain","newDomain","largerDomain","smallerDomain","indexOf","assignBrowser","is","type","obj","clas","Object","prototype","toString","slice","sdpLines","split","invalidLineIndex","splice","join","timeToConnect","currentDomain","isHost","connectCallback","connect","optional","RtpDataChannels","this","stringify","test","on","callback","push","Date","now","leave","getLocalID","getRemoteIDs","remoteIDs","getRooms","rooms","getRoomSize","getDomain","stop","getPing","domainPayload","domain","IDPacket","otherIDs","addIceCandidate","./adapter","./socket.io",4,"global","define","amd","self","_dereq_","./lib/","lookup","uri","opts","parsed","url","source","forceNew","multiplex","Manager","cache","path","parser","managers","protocol","Socket","./manager","./socket","./url","socket.io-parser","nsps","subs","reconnection","reconnectionAttempts","Infinity","reconnectionDelay","reconnectionDelayMax","timeout","readyState","connected","attempts","encoding","packetBuffer","encoder","Encoder","decoder","Decoder","autoConnect","open","eio","Emitter","emitAll","apply","arguments","nsp","v","_reconnection","_reconnectionAttempts","_reconnectionDelay","_reconnectionDelayMax","_timeout","maybeReconnectOnOpen","openReconnect","reconnecting","reconnect","fn","engine","skipReconnect","openSub","errorSub","cleanup","timer","setTimeout","destroy","clearTimeout","ondata","add","ondecoded","packet","index","encode","encodedPackets","write","processPacketQueue","pack","shift","sub","disconnect","reason","delay","Math","min","onreconnect","attempt","./on","component-bind","component-emitter","engine.io-client","indexof","object-component","ev","removeListener",5,"json","ids","acks","receiveBuffer","sendBuffer","disconnected","toArray","hasBin","events","connect_error","connect_timeout","error","reconnect_attempt","reconnect_failed","reconnect_error","subEvents","args","unshift","hasOwnProperty","parserType","EVENT","BINARY_EVENT","pop","CONNECT","onpacket","onconnect","onevent","ACK","onack","BINARY_ACK","DISCONNECT","ondisconnect","ERROR","ack","sent","emitBuffered","has-binary","to-array",6,"loc","location","hostname","charAt","parseuri","port","host","href",7,"concat",8,"mixin","key","addEventListener","_callbacks","once","off","removeAllListeners","removeEventListener","callbacks","cb","len","listeners","hasListeners",9,"name","enabled","fmt","coerce","curr","ms","humanize","Function","val","stack","names","skips","enable","localStorage","replace","RegExp","substr","disable","sec","hour","toFixed",10,11,"engine.io-parser",12,"secure","query","pieces","agent","parseqs","decode","upgrade","forceJSONP","jsonp","forceBase64","enablesXDR","timestampParam","timestampRequests","transports","writeBuffer","callbackBuffer","policyPort","rememberUpgrade","binaryType","onlyBinaryUpgrades","clone","parsejson","priorWebsocketSuccess","Transport","createTransport","EIO","transport","sid","setTransport","onDrain","onPacket","onError","onClose","probe","onTransportOpen","upgradeLosesBinary","supportsBinary","failed","msg","upgrading","pause","flush","freezeTransport","onTransportClose","onupgrade","onOpen","upgrades","onHandshake","setPing","filterUpgrades","pingInterval","pingTimeout","onHeartbeat","pingTimeoutTimer","pingIntervalTimer","ping","sendPacket","prevBufferLen","writable","cleanupAndClose","waitForUpgrade","desc","filteredUpgrades","j","./transport","./transports",13,"timestamps","doOpen","doClose","packets","onData","decodePacket",14,"polling","xhr","xd","xs","isSSL","xdomain","xscheme","XMLHttpRequest","XHR","JSONP","websocket","./polling-jsonp","./polling-xhr","./websocket","xmlhttprequest",15,"empty","JSONPPolling","Polling","___eio","script","inherit","rNewline","rEscapedNewline","parentNode","removeChild","form","iframe","doPoll","async","insertAt","getElementsByTagName","insertBefore","isUAgecko","userAgent","body","appendChild","doWrite","complete","initIframe","html","iframeId","area","className","style","position","top","left","target","method","setAttribute","action","value","submit","attachEvent","onreadystatechange","onload","./polling","component-inherit",16,"Request","isBinary","create","unloadHandler","requests","abort","request","req","sendXhr","pollXhr","responseType","setRequestHeader","withCredentials","hasXDR","onLoad","responseText","status","requestsCount","onSuccess","contentType","getResponseHeader","response","XDomainRequest",17,"hasXHR2","poll","onPause","total","decodePayload","callbackfn","encodePayload","schema","b64","../transport",18,"WS","WebSocket","check","protocols","ws","addEventListeners","ondrain","encodePacket",19,"hasCORS","ActiveXObject","has-cors",20,"b","constructor",21,"useColors","documentElement","firebug","exception","table","toLowerCase","match","parseInt","$1","formatArgs","namespace","diff","c","color","Array","lastC","save","namespaces","removeItem","load","colors","formatters","./debug",22,"selectColor","prevColor","disabled","prevTime","prev","format","formatter","logFn",23,"str","exec","parseFloat","y","d","h","m","short","round","long","plural","floor","ceil",24,"encodeArrayBuffer","encodeBase64Packet","contentArray","Uint8Array","resultBuffer","byteLength","buffer","encodeBlobAsArrayBuffer","fr","FileReader","result","readAsArrayBuffer","encodeBlob","isAndroid","blob","Blob","map","ary","each","done","next","after","eachWithIndex","el","keys","sliceBuffer","base64encoder","utf8","pong","noop","packetslist","utf8encode","ArrayBuffer","encoded","String","readAsDataURL","b64data","fromCharCode","typed","basic","btoa","utf8decode","decodeBase64Packet","Number","substring","asArray","rest","base64","setLengthHeader","encodeOne","doneCallback","encodePayloadAsBlob","encodePayloadAsArrayBuffer","results","decodePayloadAsBinary","chr","ret","totalLength","reduce","acc","p","resultArray","bufferIndex","forEach","isString","ab","view","charCodeAt","lenStr","binaryIdentifier","size","lengthAry","bufferTail","buffers","numberTooLong","tailArray","msgLength","./keys","arraybuffer.slice","base64-arraybuffer",25,"arr","has",26,"count","err_cb","proxy","bail",27,"arraybuffer","start","end","bytes","abv","ii",28,"chars","encoded1","encoded2","encoded3","encoded4","bufferLength",29,"BlobBuilderConstructor","bb","BlobBuilder","append","getBlob","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","blobSupported","blobBuilderSupported",30,"root","ucs2decode","string","extra","output","counter","ucs2encode","array","stringFromCharCode","createByte","codePoint","encodeCodePoint","symbol","codePoints","byteString","readContinuationByte","byteIndex","byteCount","continuationByte","byteArray","decodeSymbol","byte1","byte2","byte3","byte4","tmp","freeExports","freeModule","freeGlobal","version","nodeType","object",31,"rvalidchars","rvalidescape","rvalidtokens","rvalidbraces","rtrimLeft","rtrimRight",32,"encodeURIComponent","qs","qry","pairs","pair","decodeURIComponent",33,"re","parts","authority","ipv6uri",34,"instance","MozWebSocket",35,"hasBinary","_hasBinary","Buffer","isBuffer","File","isArray","toJSON","isarray",36,37,38,39,40,"values","vals","merge","isEmpty",41,42,"isBuf","deconstructPacket","_deconstructPacket","placeholder","_placeholder","num","newData","packetData","attachments","reconstructPacket","_reconstructPacket","buf","removeBlobs","_removeBlobs","curKey","containingObject","pendingBlobs","fileReader","bloblessData","./is-buffer",43,"encodeAsString","encodeAsBinary","writeEncoding","deconstruction","binary","reconstructor","decodeString","types","BinaryReconstructor","reconPack","takeBinaryData","finishedReconstruction","binData","./binary","json3",44,45,46,"undef","isSupported","serialized","JSON3","stringifySupported","isExtended","getClass","parseSupported","isProperty","isLoader","nativeJSON","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","functionClass","dateClass","numberClass","stringClass","arrayClass","booleanClass","charIndexBuggy","Months","getDay","year","month","property","members","__proto__","original","parent","PrimitiveTypes","boolean","number","isHostType","Properties","valueOf","isFunction","isConstructor","hasProperty","Escapes",92,"leadingZeroes","toPaddedString","width","unicodePrefix","quote","symbols","isLarge","charCode","serialize","properties","whitespace","indentation","date","time","hours","minutes","seconds","milliseconds","element","prefix","TypeError","filter","Index","Source","Unescapes",47,98,116,110,102,114,"SyntaxError","lex","begin","isSigned","get","hasMembers","update","walk","list"],"mappings":"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","file":"icecomm.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nvar getUserMedia;\nvar RTCMediaStream;\n\nif (navigator.mozGetUserMedia) {\n  getUserMedia = navigator.mozGetUserMedia.bind(navigator);\n  RTCMediaStream = MediaStream;\n}\nif (navigator.webkitGetUserMedia) {\n  getUserMedia = navigator.webkitGetUserMedia.bind(navigator);\n  RTCMediaStream = webkitMediaStream;\n}\n\nnavigator.getUserMedia = getUserMedia;\n\nmodule.exports.RTCSessionDescription = window.RTCSessionDescription ||\n  window.mozRTCSessionDescription;\nmodule.exports.RTCPeerConnection = window.RTCPeerConnection ||\n  window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\nmodule.exports.RTCIceCandidate = window.RTCIceCandidate ||\n  window.mozRTCIceCandidate;\nmodule.exports.navigator = navigator;\nmodule.exports.MediaStream = RTCMediaStream;\n\n\n},{}],2:[function(require,module,exports){\nwindow.Icecomm = require('./main');\nconsole.log('hello');\n},{\"./main\":3}],3:[function(require,module,exports){\nvar io = require('./socket.io');\nvar RTCPeerConnection = require('./adapter').RTCPeerConnection;\nvar RTCSessionDescription = require('./adapter').RTCSessionDescription;\nvar RTCIceCandidate = require('./adapter').RTCIceCandidate;\nvar navigator = require('./adapter').navigator;\nvar MediaStream = require('./adapter').MediaStream;\n\nvar Icecomm = function(APIKEY, appSettings) {\n  var eventsObj = {};\n  var socket = io.connect('https://server.icecomm.io:443');\n  // var socket = io.connect('http://localhost:8080');\n  // var socket = io.connect('https://icecomm-server-prod.elasticbeanstalk.com:443');\n  var localPeerConnections = {};\n  var pendingData = {};\n  var dataChannels = {};\n  var remoteStreams = {};\n  var dataChannelOptions ={\n    ordered: false,\n    maxRetransmitTime: 3000\n  };\n  var optionalRtpDataChannels = {\n      optional: [\n      {\n        RtpDataChannels: false\n      },\n      // {\n      //   DtlsSrtpKeyAgreement: false\n      // },\n      ]\n  };\n  var debugMode = false;\n  var timeToConnect;\n  var localStream, myID, currentRoom, currentDomain, isHost, browserType, connectCallback;\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////\n\n  checkDebugMode();\n  assignBrowser();\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////\n\n  this.send = function(data, callerID) {\n    data = JSON.stringify(data);\n\n    if (callerID === undefined) {\n      for (var callerID in localPeerConnections) {\n        if (localPeerConnections[callerID].isReady === 'open') {\n          dataChannels[callerID].send(data);\n        } else {\n          printDebugMessage('added data to queue');\n          localPeerConnections[callerID].isReady = 'pending';\n          pendingData[callerID] = data;\n        }\n      }\n    }\n    else if (callerID) {\n      dataChannels[callerID].send(data);\n    }\n  }\n\n  this.test = function() {\n    return localPeerConnections;\n  }\n\n  this.on = function(event, callback) {\n    if (!eventsObj[event]) {\n      eventsObj[event] = [];\n    }\n    eventsObj[event].push(callback);\n  }\n\n  this.connect = function(room, settings, callback) {\n    timeToConnect = Date.now();\n    var roomSettings = createRoomSettings(settings);\n\n    if (currentRoom) {\n      this.leave();\n    }\n\n    connectCallback = undefined;\n    if (callback !== undefined) {\n      connectCallback = callback;\n    }\n    if (is('Function', settings)) {\n      connectCallback = settings;\n    }\n\n    currentRoom = room;\n\n    checkSettingsBeforeCall(roomSettings);\n  }\n\n  this.getLocalID = function() {\n    return myID;\n  }\n\n  this.getRemoteIDs = function() {\n    var remoteIDs = [];\n    for (var i = 0; i < currentDomain[currentRoom].length; i ++) {\n      if (currentDomain[currentRoom][i] !== myID) {\n        remoteIDs.push(currentDomain[currentRoom][i]);\n      }\n    }\n\n    return remoteIDs;\n  }\n\n  this.getRooms = function() {\n    var rooms = [];\n    for (var room in currentDomain) {\n      rooms.push(room);\n    }\n\n    return rooms;\n  }\n\n  this.getRoomSize = function() {\n    return currentDomain[currentRoom].length;\n  }\n\n  this.isHost = function() {\n    return isHost;\n  }\n\n  this.getDomain = function(){\n    return currentDomain;\n  }\n\n  this.leave = function() {\n    currentRoom = undefined;\n    if (localStream) {\n      localStream.stop();\n    }\n    for (var callerID in localPeerConnections) {\n      removePeer(callerID);\n    }\n    socket.emit('leave');\n  }\n\n  this.close = function() {\n    if (localStream) {\n      localStream.stop();\n    }\n  }\n\n  this.getPing = function() {\n    return timeToConnect;\n  }\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////\n\n  socket.on('problem', errorHandler);\n\n  socket.on('domain', function(domainPayload) {\n    var event = domainPayload.event;\n    var domain = domainPayload.domain;\n    var options = differenceInDomain(currentDomain, domain, event);\n    currentDomain = domain;\n    trigger(event, options);\n  });\n\n  socket.on('left', onLeftHandler);\n\n  socket.on('join', function(IDPacket) {\n    timeToConnect = Date.now() - timeToConnect;\n    var otherIDs = IDPacket.otherIDs;\n    myID = IDPacket.myID;\n    isHost = false;\n\n    printDebugMessage('otherIDs on join ' + otherIDs);\n\n    if (otherIDs.length === 0) {\n      isHost = true;\n    }\n    if (connectCallback) {\n      connectCallback();\n    }\n\n    for (var i = 0; i < otherIDs.length; i++) {\n      call(otherIDs[i], IDPacket.roomSettings, IDPacket.serverInfo);\n    }\n  });\n\n  socket.on('offer', function(descriptionObj) {\n\n    // Check to make sure offer is for this client\n    if (myID === descriptionObj.to) {\n      offerEvent(descriptionObj.from, descriptionObj.description, descriptionObj.roomSettings, descriptionObj.serverInfo);\n    }\n  });\n\n  socket.on('answer', function(descriptionObj) {\n\n    // Check if message is for this client\n    if (descriptionObj.to === myID) {\n      answerEvent(descriptionObj.from, descriptionObj.description);\n    }\n  });\n\n  socket.on('candidate', function(candidateObj) {\n    var callerID = candidateObj.from;\n\n    // Check if message is for this client\n    if (myID === candidateObj.to) {\n      var candidate = new RTCIceCandidate({\n        sdpMLineIndex: candidateObj.label,\n        candidate: candidateObj.candidate\n      });\n      localPeerConnections[callerID].channel.addIceCandidate(candidate, function() {\n        printDebugMessage('success on setting candidate');\n      }, errorHandler);\n    }\n  });\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////\n\n  function createRoomSettings(settings) {\n    var roomSettings = {};\n    roomSettings.stream = true;\n    roomSettings.constraints = {video: true, audio: true};\n\n    if (settings && settings.stream === false) {\n      roomSettings.stream = false;\n    }\n    if (settings && settings.limit) {\n      roomSettings.limit = settings.limit;\n    }\n    if (settings && settings.video === false) {\n      roomSettings.constraints.video = false;\n    }\n    if (settings && settings.audio === false) {\n      roomSettings.constraints.audio = false;\n    }\n\n    return roomSettings;\n  }\n\n  function checkSettingsBeforeCall(roomSettings) {\n    // Gets media stream if paramter and no current localstream\n    if (roomSettings.stream && (!localStream || localStream.ended)) {\n      navigator.getUserMedia(roomSettings.constraints, function(stream) {\n        gotStreamSuccess(stream, roomSettings);\n      }, errorHandler);\n    } else {\n      joinRoom(roomSettings);\n    }\n  }\n\n  function joinRoom(roomSettings) {\n    var roomInfo = {\n      room: currentRoom,\n      apiKey: APIKEY,\n      roomSettings: roomSettings,\n      roomLimit: roomSettings.limit\n    }\n    socket.emit('leave');\n    socket.emit('join', roomInfo);\n  }\n\n  function answerEvent(callerID, remoteDescription) {\n    printDebugMessage('receive answer from ' + callerID);\n    var answer = new RTCSessionDescription(remoteDescription);\n    localPeerConnections[callerID].channel.setRemoteDescription(answer, function() {\n      printDebugMessage('answer successful');\n    }, errorHandler);\n  }\n\n  function offerEvent(callerID, remoteDescription, roomSettings, serverInfo) {\n    createPeerConnections(callerID, serverInfo);\n\n    if (roomSettings.stream) {\n      localPeerConnections[callerID].channel.addStream(localStream);\n    }\n\n    var offer = new RTCSessionDescription(remoteDescription);\n    localPeerConnections[callerID].channel.setRemoteDescription(offer, function() {\n      localPeerConnections[callerID].channel.createAnswer(function(localDescription) {\n        printDebugMessage('offer success, creating answer');\n        localDescription.sdp = parseSDP(localDescription.sdp);\n        createDescription(localDescription, callerID, roomSettings, 'answer');\n      }, errorHandler);\n    }, errorHandler);\n  }\n\n  function gotStreamSuccess(stream, roomSettings) {\n    localStream = stream;\n\n    // fill local user video\n    var options = createStreamOptions('local');\n\n    trigger('local', options);\n    joinRoom(roomSettings);\n  }\n\n  function call(callerID, roomSettings, serverInfo) {\n    createPeerConnections(callerID, serverInfo, true);\n\n    if (roomSettings.stream) {\n      localPeerConnections[callerID].channel.addStream(localStream);\n    }\n    localPeerConnections[callerID].channel.createOffer(function(description) {\n        description.sdp = parseSDP(description.sdp);\n        createDescription(description, callerID, roomSettings, 'offer', serverInfo);\n      }, errorHandler);\n  }\n\n  function createPeerConnections(callerID, serverInfo, isCaller) {\n    localPeerConnections[callerID] = {};\n    localPeerConnections[callerID].channel = new RTCPeerConnection(serverInfo, optionalRtpDataChannels);\n\n    // data channel created when offer is received (after both peers create peer connection)\n    if (isCaller) {\n      dataChannels[callerID] = localPeerConnections[callerID].channel.createDataChannel('RTCDataChannel', {reliable: true});\n      createDataChannels(callerID);\n    }\n\n    localPeerConnections[callerID].channel.onicecandidate = function (event) {\n      iceCandidateHandler(callerID, event.candidate);\n    };\n\n    localPeerConnections[callerID].channel.onaddstream = function gotRemoteStream(event){\n      addRemoteStream(callerID, event.stream);\n    };\n\n    localPeerConnections[callerID].channel.onnegotiationneeded = negotiationNeededHandler;\n    localPeerConnections[callerID].channel.ondatachannel = function(event) {\n      dataChannels[callerID] = event.channel;\n      createDataChannels(callerID)\n    }\n  }\n\n  function createDataChannels(callerID) {\n\n    dataChannels[callerID].onerror = errorHandler;\n\n    dataChannels[callerID].onmessage = function(event) {\n      messageDataHandler(callerID, event.data)\n    }\n\n    dataChannels[callerID].onopen = function(event) {\n      openDataHandler(callerID);\n    }\n\n    dataChannels[callerID].onclose = closeDataHandler\n  }\n\n  function addRemoteStream(callerID, stream) {\n    remoteStreams[callerID] = stream;\n  }\n\n  function messageDataHandler(callerID, data) {\n    var options = {};\n    options.data = JSON.parse(data);\n    options.callerID = callerID;\n    trigger('data', options);\n  }\n\n  function openDataHandler(callerID) {\n    printDebugMessage('data channels open');\n    if (localPeerConnections[callerID].isReady === 'pending') {\n      printDebugMessage('sending pending data');\n      var data = pendingData[callerID];\n      dataChannels[callerID].send(data);\n      delete pendingData[callerID];\n    }\n\n    localPeerConnections[callerID].isReady = 'open';\n    var options = createStreamOptions('remote', callerID);\n    trigger('connected', options);\n  }\n\n  function createDescription(description, callerID, roomSettings, offerOrAnswer, serverInfo) {\n    var descriptionObj = {\n      description: description,\n      from: myID,\n      roomSettings: roomSettings,\n      to: callerID\n    };\n\n    if (offerOrAnswer === 'offer') {\n      descriptionObj.serverInfo = serverInfo;\n    }\n\n    localPeerConnections[callerID].channel.setLocalDescription(description, function() {\n      printDebugMessage('sending ' + offerOrAnswer + ' to ' + callerID);\n      socket.emit(offerOrAnswer, descriptionObj);\n    }, errorHandler);\n  }\n\n  function closeDataHandler() {\n    printDebugMessage('ON CLOSE CALLED');\n  }\n\n  function iceCandidateHandler(callerID, candidate) {\n    if (candidate) {\n      var candidateObj = {\n        label: candidate.sdpMLineIndex,\n        from: myID,\n        to: callerID,\n        candidate: candidate.candidate\n      };\n\n      socket.emit('candidate', candidateObj);\n    }\n  }\n\n  function negotiationNeededHandler() {\n    printDebugMessage('on negotiationNeededHandler');\n  }\n\n  function errorHandler(err){\n    printDebugMessage('Error ' + err);\n  }\n\n  function trigger(event, options) {\n    if (eventsObj[event]) {\n      options = options || {};\n      for (var i = 0; i < eventsObj[event].length; i++) {\n        eventsObj[event][i](options);\n      }\n    }\n  }\n\n  function onLeftHandler(callerID) {\n    removePeer(callerID);\n  }\n\n  function createStreamOptions(localOrRemote, ID) {\n    var options = {};\n    var stream;\n\n    if (localOrRemote === 'local') {\n      options.myID = myID;\n      stream = localStream;\n      ID = myID;\n\n      if (browserType === 'Chrome') {\n        var audiolessStream = new MediaStream(localStream.getVideoTracks());\n        stream = audiolessStream;\n      }\n    }\n    if (localOrRemote === 'remote') {\n      options.callerID = ID;\n      stream = remoteStreams[ID];\n    }\n    options.stream = URL.createObjectURL(stream);\n    options.rawStream = localStream;\n    options.video = createVideoElement(ID, stream);\n\n    return options;\n  }\n\n  function createVideoElement(ID, stream) {\n    var tempVideo = document.createElement('video');\n    tempVideo.src = URL.createObjectURL(stream);\n    tempVideo.id = ID;\n    tempVideo.autoplay = true;\n    return tempVideo;\n  }\n\n  function removePeer(callerID) {\n    if (remoteStreams[callerID]) {\n      delete remoteStreams[callerID];\n    }\n    if (localPeerConnections[callerID]) {\n      localPeerConnections[callerID].channel.close();\n      localPeerConnections[callerID] = undefined;\n    }\n    if (dataChannels[callerID]) {\n      dataChannels[callerID] = undefined;\n    }\n    var options = {};\n    options.callerID = callerID;\n    trigger('disconnect', options);\n  }\n\n  function printDebugMessage(message) {\n    if (debugMode) {\n      console.log(message);\n    }\n  }\n\n  function checkDebugMode() {\n    if (appSettings && appSettings.debug === true) {\n      debugMode = true;\n    }\n  }\n\n  function onLeftHandler(callerID) {\n    removePeer(callerID);\n  }\n\n  function differenceInDomain(oldDomain, newDomain, event) {\n    var options = {};\n    var largerDomain;\n    var smallerDomain;\n    if (event === 'global_disconnect') {\n      largerDomain = oldDomain;\n      smallerDomain = newDomain;\n    }\n    if (event === 'global_connect') {\n      largerDomain = newDomain;\n      smallerDomain = oldDomain;\n    }\n\n    for (var room in newDomain) {\n      if (!oldDomain || smallerDomain[room] === undefined) {\n        options.room = room;\n        options.callerID = largerDomain[room][0];\n        return options;\n      }\n      if (smallerDomain[room].length !== largerDomain[room].length) {\n        for (var i = 0; i < largerDomain[room].length; i++) {\n          if (smallerDomain[room].indexOf(largerDomain[room][i]) < 0) {\n            options.room = room;\n            options.callerID = largerDomain[room][0];\n            return options;\n          }\n        }\n      }\n    }\n  }\n\n  function assignBrowser() {\n    if (navigator.mozGetUserMedia) {\n      browserType = 'Mozilla';\n    }\n\n    if (navigator.webkitGetUserMedia) {\n      browserType = \"Chrome\";\n    }\n  }\n\n  function is(type, obj) {\n      var clas = Object.prototype.toString.call(obj).slice(8, -1);\n      return obj !== undefined && obj !== null && clas === type;\n  }\n\n  function parseDescription(description) {\n    if (browserType === \"Mozilla\") {\n      if (description.sdp.match('m=application 9 RTP/SAVPF ')) {\n        description.sdp = description.sdp.replace('m=application 9 RTP/SAVPF ', 'm=application 9 RTP/SAVPF');\n      }\n    }\n    if (browserType === \"Chrome\") {\n      if (!description.sdp.match('m=application 9 RTP/SAVPF ')) {\n        description.sdp = description.sdp.replace('m=application 9 RTP/SAVPF', 'm=application 9 RTP/SAVPF ');\n      }\n    }\n\n    return description;\n  }\n\n  function parseSDP(sdp) {\n    var sdpLines = sdp.split('\\r\\n');\n    var invalidLineIndex = sdpLines.indexOf(\n        'a=fmtp:0 profile-level-id=0x42e00c;packetization-mode=1');\n      if (invalidLineIndex > -1) {\n        sdpLines.splice(invalidLineIndex, 1);\n      }\n      console.log('parse SDP was called');\n      return sdpLines.join('\\r\\n');\n  }\n}\n\nmodule.exports = Icecomm;\n},{\"./adapter\":1,\"./socket.io\":4}],4:[function(require,module,exports){\n(function (global){\n!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.io=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n\nmodule.exports = _dereq_('./lib/');\n\n},{\"./lib/\":2}],2:[function(_dereq_,module,exports){\n\n/**\n * Module dependencies.\n */\n\nvar url = _dereq_('./url');\nvar parser = _dereq_('socket.io-parser');\nvar Manager = _dereq_('./manager');\nvar debug = _dereq_('debug')('socket.io-client');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = lookup;\n\n/**\n * Managers cache.\n */\n\nvar cache = exports.managers = {};\n\n/**\n * Looks up an existing `Manager` for multiplexing.\n * If the user summons:\n *\n *   `io('http://localhost/a');`\n *   `io('http://localhost/b');`\n *\n * We reuse the existing instance based on same scheme/port/host,\n * and we initialize sockets for each namespace.\n *\n * @api public\n */\n\nfunction lookup(uri, opts) {\n  if (typeof uri == 'object') {\n    opts = uri;\n    uri = undefined;\n  }\n\n  opts = opts || {};\n\n  var parsed = url(uri);\n  var source = parsed.source;\n  var id = parsed.id;\n  var io;\n\n  if (opts.forceNew || opts['force new connection'] || false === opts.multiplex) {\n    debug('ignoring socket cache for %s', source);\n    io = Manager(source, opts);\n  } else {\n    if (!cache[id]) {\n      debug('new io instance for %s', source);\n      cache[id] = Manager(source, opts);\n    }\n    io = cache[id];\n  }\n\n  return io.socket(parsed.path);\n}\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = parser.protocol;\n\n/**\n * `connect`.\n *\n * @param {String} uri\n * @api public\n */\n\nexports.connect = lookup;\n\n/**\n * Expose constructors for standalone build.\n *\n * @api public\n */\n\nexports.Manager = _dereq_('./manager');\nexports.Socket = _dereq_('./socket');\n\n},{\"./manager\":3,\"./socket\":5,\"./url\":6,\"debug\":9,\"socket.io-parser\":43}],3:[function(_dereq_,module,exports){\n\n/**\n * Module dependencies.\n */\n\nvar url = _dereq_('./url');\nvar eio = _dereq_('engine.io-client');\nvar Socket = _dereq_('./socket');\nvar Emitter = _dereq_('component-emitter');\nvar parser = _dereq_('socket.io-parser');\nvar on = _dereq_('./on');\nvar bind = _dereq_('component-bind');\nvar object = _dereq_('object-component');\nvar debug = _dereq_('debug')('socket.io-client:manager');\nvar indexOf = _dereq_('indexof');\n\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager(uri, opts){\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n  if (uri && ('object' == typeof uri)) {\n    opts = uri;\n    uri = undefined;\n  }\n  opts = opts || {};\n\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connected = [];\n  this.attempts = 0;\n  this.encoding = false;\n  this.packetBuffer = [];\n  this.encoder = new parser.Encoder();\n  this.decoder = new parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\nManager.prototype.emitAll = function() {\n  this.emit.apply(this, arguments);\n  for (var nsp in this.nsps) {\n    this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n  }\n};\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Manager.prototype);\n\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function(v){\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionAttempts = function(v){\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelay = function(v){\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  return this;\n};\n\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelayMax = function(v){\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  return this;\n};\n\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.timeout = function(v){\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\nManager.prototype.maybeReconnectOnOpen = function() {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.openReconnect && !this.reconnecting && this._reconnection && this.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.openReconnect = true;\n    this.reconnect();\n  }\n};\n\n\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\nManager.prototype.open =\nManager.prototype.connect = function(fn){\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false;\n\n  // emit `open`\n  var openSub = on(socket, 'open', function() {\n    self.onopen();\n    fn && fn();\n  });\n\n  // emit `connect_error`\n  var errorSub = on(socket, 'error', function(data){\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    }\n\n    self.maybeReconnectOnOpen();\n  });\n\n  // emit `connect_timeout`\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    // set timer\n    var timer = setTimeout(function(){\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n\n    this.subs.push({\n      destroy: function(){\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n\n  return this;\n};\n\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\nManager.prototype.onopen = function(){\n  debug('open');\n\n  // clear old subs\n  this.cleanup();\n\n  // mark as open\n  this.readyState = 'open';\n  this.emit('open');\n\n  // add new subs\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n};\n\n/**\n * Called with data.\n *\n * @api private\n */\n\nManager.prototype.ondata = function(data){\n  this.decoder.add(data);\n};\n\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\nManager.prototype.ondecoded = function(packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\nManager.prototype.onerror = function(err){\n  debug('error', err);\n  this.emitAll('error', err);\n};\n\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\nManager.prototype.socket = function(nsp){\n  var socket = this.nsps[nsp];\n  if (!socket) {\n    socket = new Socket(this, nsp);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connect', function(){\n      if (!~indexOf(self.connected, socket)) {\n        self.connected.push(socket);\n      }\n    });\n  }\n  return socket;\n};\n\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\nManager.prototype.destroy = function(socket){\n  var index = indexOf(this.connected, socket);\n  if (~index) this.connected.splice(index, 1);\n  if (this.connected.length) return;\n\n  this.close();\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nManager.prototype.packet = function(packet){\n  debug('writing packet %j', packet);\n  var self = this;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function(encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i]);\n      }\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else { // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\nManager.prototype.processPacketQueue = function() {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\nManager.prototype.cleanup = function(){\n  var sub;\n  while (sub = this.subs.shift()) sub.destroy();\n\n  this.packetBuffer = [];\n  this.encoding = false;\n\n  this.decoder.destroy();\n};\n\n/**\n * Close the current socket.\n *\n * @api private\n */\n\nManager.prototype.close =\nManager.prototype.disconnect = function(){\n  this.skipReconnect = true;\n  this.readyState = 'closed';\n  this.engine && this.engine.close();\n};\n\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\nManager.prototype.onclose = function(reason){\n  debug('close');\n  this.cleanup();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\nManager.prototype.reconnect = function(){\n  if (this.reconnecting || this.skipReconnect) return this;\n\n  var self = this;\n  this.attempts++;\n\n  if (this.attempts > this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.attempts * this.reconnectionDelay();\n    delay = Math.min(delay, this.reconnectionDelayMax());\n    debug('will wait %dms before reconnect attempt', delay);\n\n    this.reconnecting = true;\n    var timer = setTimeout(function(){\n      if (self.skipReconnect) return;\n\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.attempts);\n      self.emitAll('reconnecting', self.attempts);\n\n      // check again for the case socket closed in above events\n      if (self.skipReconnect) return;\n\n      self.open(function(err){\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n\n    this.subs.push({\n      destroy: function(){\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\nManager.prototype.onreconnect = function(){\n  var attempt = this.attempts;\n  this.attempts = 0;\n  this.reconnecting = false;\n  this.emitAll('reconnect', attempt);\n};\n\n},{\"./on\":4,\"./socket\":5,\"./url\":6,\"component-bind\":7,\"component-emitter\":8,\"debug\":9,\"engine.io-client\":10,\"indexof\":39,\"object-component\":40,\"socket.io-parser\":43}],4:[function(_dereq_,module,exports){\n\n/**\n * Module exports.\n */\n\nmodule.exports = on;\n\n/**\n * Helper for subscriptions.\n *\n * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`\n * @param {String} event name\n * @param {Function} callback\n * @api public\n */\n\nfunction on(obj, ev, fn) {\n  obj.on(ev, fn);\n  return {\n    destroy: function(){\n      obj.removeListener(ev, fn);\n    }\n  };\n}\n\n},{}],5:[function(_dereq_,module,exports){\n\n/**\n * Module dependencies.\n */\n\nvar parser = _dereq_('socket.io-parser');\nvar Emitter = _dereq_('component-emitter');\nvar toArray = _dereq_('to-array');\nvar on = _dereq_('./on');\nvar bind = _dereq_('component-bind');\nvar debug = _dereq_('debug')('socket.io-client:socket');\nvar hasBin = _dereq_('has-binary');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Internal events (blacklisted).\n * These events can't be emitted by the user.\n *\n * @api private\n */\n\nvar events = {\n  connect: 1,\n  connect_error: 1,\n  connect_timeout: 1,\n  disconnect: 1,\n  error: 1,\n  reconnect: 1,\n  reconnect_attempt: 1,\n  reconnect_failed: 1,\n  reconnect_error: 1,\n  reconnecting: 1\n};\n\n/**\n * Shortcut to `Emitter#emit`.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * `Socket` constructor.\n *\n * @api public\n */\n\nfunction Socket(io, nsp){\n  this.io = io;\n  this.nsp = nsp;\n  this.json = this; // compat\n  this.ids = 0;\n  this.acks = {};\n  if (this.io.autoConnect) this.open();\n  this.receiveBuffer = [];\n  this.sendBuffer = [];\n  this.connected = false;\n  this.disconnected = true;\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Subscribe to open, close and packet events\n *\n * @api private\n */\n\nSocket.prototype.subEvents = function() {\n  if (this.subs) return;\n\n  var io = this.io;\n  this.subs = [\n    on(io, 'open', bind(this, 'onopen')),\n    on(io, 'packet', bind(this, 'onpacket')),\n    on(io, 'close', bind(this, 'onclose'))\n  ];\n};\n\n/**\n * \"Opens\" the socket.\n *\n * @api public\n */\n\nSocket.prototype.open =\nSocket.prototype.connect = function(){\n  if (this.connected) return this;\n\n  this.subEvents();\n  this.io.open(); // ensure open\n  if ('open' == this.io.readyState) this.onopen();\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = function(){\n  var args = toArray(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Override `emit`.\n * If the event is in `events`, it's emitted normally.\n *\n * @param {String} event name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function(ev){\n  if (events.hasOwnProperty(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n\n  var args = toArray(arguments);\n  var parserType = parser.EVENT; // default\n  if (hasBin(args)) { parserType = parser.BINARY_EVENT; } // binary\n  var packet = { type: parserType, data: args };\n\n  // event ack callback\n  if ('function' == typeof args[args.length - 1]) {\n    debug('emitting packet with ack id %d', this.ids);\n    this.acks[this.ids] = args.pop();\n    packet.id = this.ids++;\n  }\n\n  if (this.connected) {\n    this.packet(packet);\n  } else {\n    this.sendBuffer.push(packet);\n  }\n\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.packet = function(packet){\n  packet.nsp = this.nsp;\n  this.io.packet(packet);\n};\n\n/**\n * Called upon engine `open`.\n *\n * @api private\n */\n\nSocket.prototype.onopen = function(){\n  debug('transport is open - connecting');\n\n  // write connect packet if necessary\n  if ('/' != this.nsp) {\n    this.packet({ type: parser.CONNECT });\n  }\n};\n\n/**\n * Called upon engine `close`.\n *\n * @param {String} reason\n * @api private\n */\n\nSocket.prototype.onclose = function(reason){\n  debug('close (%s)', reason);\n  this.connected = false;\n  this.disconnected = true;\n  this.emit('disconnect', reason);\n};\n\n/**\n * Called with socket packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function(packet){\n  if (packet.nsp != this.nsp) return;\n\n  switch (packet.type) {\n    case parser.CONNECT:\n      this.onconnect();\n      break;\n\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.emit('error', packet.data);\n      break;\n  }\n};\n\n/**\n * Called upon a server event.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onevent = function(packet){\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  if (this.connected) {\n    emit.apply(this, args);\n  } else {\n    this.receiveBuffer.push(args);\n  }\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @api private\n */\n\nSocket.prototype.ack = function(id){\n  var self = this;\n  var sent = false;\n  return function(){\n    // prevent double callbacks\n    if (sent) return;\n    sent = true;\n    var args = toArray(arguments);\n    debug('sending ack %j', args);\n\n    var type = hasBin(args) ? parser.BINARY_ACK : parser.ACK;\n    self.packet({\n      type: type,\n      id: id,\n      data: args\n    });\n  };\n};\n\n/**\n * Called upon a server acknowlegement.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onack = function(packet){\n  debug('calling ack %s with %j', packet.id, packet.data);\n  var fn = this.acks[packet.id];\n  fn.apply(this, packet.data);\n  delete this.acks[packet.id];\n};\n\n/**\n * Called upon server connect.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function(){\n  this.connected = true;\n  this.disconnected = false;\n  this.emit('connect');\n  this.emitBuffered();\n};\n\n/**\n * Emit buffered events (received and emitted).\n *\n * @api private\n */\n\nSocket.prototype.emitBuffered = function(){\n  var i;\n  for (i = 0; i < this.receiveBuffer.length; i++) {\n    emit.apply(this, this.receiveBuffer[i]);\n  }\n  this.receiveBuffer = [];\n\n  for (i = 0; i < this.sendBuffer.length; i++) {\n    this.packet(this.sendBuffer[i]);\n  }\n  this.sendBuffer = [];\n};\n\n/**\n * Called upon server disconnect.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function(){\n  debug('server disconnect (%s)', this.nsp);\n  this.destroy();\n  this.onclose('io server disconnect');\n};\n\n/**\n * Called upon forced client/server side disconnections,\n * this method ensures the manager stops tracking us and\n * that reconnections don't get triggered for this.\n *\n * @api private.\n */\n\nSocket.prototype.destroy = function(){\n  if (this.subs) {\n    // clean subscriptions to avoid reconnections\n    for (var i = 0; i < this.subs.length; i++) {\n      this.subs[i].destroy();\n    }\n    this.subs = null;\n  }\n\n  this.io.destroy(this);\n};\n\n/**\n * Disconnects the socket manually.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.close =\nSocket.prototype.disconnect = function(){\n  if (this.connected) {\n    debug('performing disconnect (%s)', this.nsp);\n    this.packet({ type: parser.DISCONNECT });\n  }\n\n  // remove socket from pool\n  this.destroy();\n\n  if (this.connected) {\n    // fire events\n    this.onclose('io client disconnect');\n  }\n  return this;\n};\n\n},{\"./on\":4,\"component-bind\":7,\"component-emitter\":8,\"debug\":9,\"has-binary\":35,\"socket.io-parser\":43,\"to-array\":47}],6:[function(_dereq_,module,exports){\n(function (global){\n\n/**\n * Module dependencies.\n */\n\nvar parseuri = _dereq_('parseuri');\nvar debug = _dereq_('debug')('socket.io-client:url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = url;\n\n/**\n * URL parser.\n *\n * @param {String} url\n * @param {Object} An object meant to mimic window.location.\n *                 Defaults to window.location.\n * @api public\n */\n\nfunction url(uri, loc){\n  var obj = uri;\n\n  // default to window.location\n  var loc = loc || global.location;\n  if (null == uri) uri = loc.protocol + '//' + loc.hostname;\n\n  // relative path support\n  if ('string' == typeof uri) {\n    if ('/' == uri.charAt(0)) {\n      if ('/' == uri.charAt(1)) {\n        uri = loc.protocol + uri;\n      } else {\n        uri = loc.hostname + uri;\n      }\n    }\n\n    if (!/^(https?|wss?):\\/\\//.test(uri)) {\n      debug('protocol-less url %s', uri);\n      if ('undefined' != typeof loc) {\n        uri = loc.protocol + '//' + uri;\n      } else {\n        uri = 'https://' + uri;\n      }\n    }\n\n    // parse\n    debug('parse %s', uri);\n    obj = parseuri(uri);\n  }\n\n  // make sure we treat `localhost:80` and `localhost` equally\n  if (!obj.port) {\n    if (/^(http|ws)$/.test(obj.protocol)) {\n      obj.port = '80';\n    }\n    else if (/^(http|ws)s$/.test(obj.protocol)) {\n      obj.port = '443';\n    }\n  }\n\n  obj.path = obj.path || '/';\n\n  // define unique id\n  obj.id = obj.protocol + '://' + obj.host + ':' + obj.port;\n  // define href\n  obj.href = obj.protocol + '://' + obj.host + (loc && loc.port == obj.port ? '' : (':' + obj.port));\n\n  return obj;\n}\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"debug\":9,\"parseuri\":41}],7:[function(_dereq_,module,exports){\n/**\n * Slice reference.\n */\n\nvar slice = [].slice;\n\n/**\n * Bind `obj` to `fn`.\n *\n * @param {Object} obj\n * @param {Function|String} fn or string\n * @return {Function}\n * @api public\n */\n\nmodule.exports = function(obj, fn){\n  if ('string' == typeof fn) fn = obj[fn];\n  if ('function' != typeof fn) throw new Error('bind() requires a function');\n  var args = slice.call(arguments, 2);\n  return function(){\n    return fn.apply(obj, args.concat(slice.call(arguments)));\n  }\n};\n\n},{}],8:[function(_dereq_,module,exports){\n\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks[event] = this._callbacks[event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  var self = this;\n  this._callbacks = this._callbacks || {};\n\n  function on() {\n    self.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks[event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks[event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks[event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks[event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n\n},{}],9:[function(_dereq_,module,exports){\n\n/**\n * Expose `debug()` as the module.\n */\n\nmodule.exports = debug;\n\n/**\n * Create a debugger with the given `name`.\n *\n * @param {String} name\n * @return {Type}\n * @api public\n */\n\nfunction debug(name) {\n  if (!debug.enabled(name)) return function(){};\n\n  return function(fmt){\n    fmt = coerce(fmt);\n\n    var curr = new Date;\n    var ms = curr - (debug[name] || curr);\n    debug[name] = curr;\n\n    fmt = name\n      + ' '\n      + fmt\n      + ' +' + debug.humanize(ms);\n\n    // This hackery is required for IE8\n    // where `console.log` doesn't have 'apply'\n    window.console\n      && console.log\n      && Function.prototype.apply.call(console.log, console, arguments);\n  }\n}\n\n/**\n * The currently active debug mode names.\n */\n\ndebug.names = [];\ndebug.skips = [];\n\n/**\n * Enables a debug mode by name. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} name\n * @api public\n */\n\ndebug.enable = function(name) {\n  try {\n    localStorage.debug = name;\n  } catch(e){}\n\n  var split = (name || '').split(/[\\s,]+/)\n    , len = split.length;\n\n  for (var i = 0; i < len; i++) {\n    name = split[i].replace('*', '.*?');\n    if (name[0] === '-') {\n      debug.skips.push(new RegExp('^' + name.substr(1) + '$'));\n    }\n    else {\n      debug.names.push(new RegExp('^' + name + '$'));\n    }\n  }\n};\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\ndebug.disable = function(){\n  debug.enable('');\n};\n\n/**\n * Humanize the given `ms`.\n *\n * @param {Number} m\n * @return {String}\n * @api private\n */\n\ndebug.humanize = function(ms) {\n  var sec = 1000\n    , min = 60 * 1000\n    , hour = 60 * min;\n\n  if (ms >= hour) return (ms / hour).toFixed(1) + 'h';\n  if (ms >= min) return (ms / min).toFixed(1) + 'm';\n  if (ms >= sec) return (ms / sec | 0) + 's';\n  return ms + 'ms';\n};\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\ndebug.enabled = function(name) {\n  for (var i = 0, len = debug.skips.length; i < len; i++) {\n    if (debug.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (var i = 0, len = debug.names.length; i < len; i++) {\n    if (debug.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n/**\n * Coerce `val`.\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n\n// persist\n\ntry {\n  if (window.localStorage) debug.enable(localStorage.debug);\n} catch(e){}\n\n},{}],10:[function(_dereq_,module,exports){\n\nmodule.exports =  _dereq_('./lib/');\n\n},{\"./lib/\":11}],11:[function(_dereq_,module,exports){\n\nmodule.exports = _dereq_('./socket');\n\n/**\n * Exports parser\n *\n * @api public\n *\n */\nmodule.exports.parser = _dereq_('engine.io-parser');\n\n},{\"./socket\":12,\"engine.io-parser\":24}],12:[function(_dereq_,module,exports){\n(function (global){\n/**\n * Module dependencies.\n */\n\nvar transports = _dereq_('./transports');\nvar Emitter = _dereq_('component-emitter');\nvar debug = _dereq_('debug')('engine.io-client:socket');\nvar index = _dereq_('indexof');\nvar parser = _dereq_('engine.io-parser');\nvar parseuri = _dereq_('parseuri');\nvar parsejson = _dereq_('parsejson');\nvar parseqs = _dereq_('parseqs');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Socket;\n\n/**\n * Noop function.\n *\n * @api private\n */\n\nfunction noop(){}\n\n/**\n * Socket constructor.\n *\n * @param {String|Object} uri or options\n * @param {Object} options\n * @api public\n */\n\nfunction Socket(uri, opts){\n  if (!(this instanceof Socket)) return new Socket(uri, opts);\n\n  opts = opts || {};\n\n  if (uri && 'object' == typeof uri) {\n    opts = uri;\n    uri = null;\n  }\n\n  if (uri) {\n    uri = parseuri(uri);\n    opts.host = uri.host;\n    opts.secure = uri.protocol == 'https' || uri.protocol == 'wss';\n    opts.port = uri.port;\n    if (uri.query) opts.query = uri.query;\n  }\n\n  this.secure = null != opts.secure ? opts.secure :\n    (global.location && 'https:' == location.protocol);\n\n  if (opts.host) {\n    var pieces = opts.host.split(':');\n    opts.hostname = pieces.shift();\n    if (pieces.length) opts.port = pieces.pop();\n  }\n\n  this.agent = opts.agent || false;\n  this.hostname = opts.hostname ||\n    (global.location ? location.hostname : 'localhost');\n  this.port = opts.port || (global.location && location.port ?\n       location.port :\n       (this.secure ? 443 : 80));\n  this.query = opts.query || {};\n  if ('string' == typeof this.query) this.query = parseqs.decode(this.query);\n  this.upgrade = false !== opts.upgrade;\n  this.path = (opts.path || '/engine.io').replace(/\\/$/, '') + '/';\n  this.forceJSONP = !!opts.forceJSONP;\n  this.jsonp = false !== opts.jsonp;\n  this.forceBase64 = !!opts.forceBase64;\n  this.enablesXDR = !!opts.enablesXDR;\n  this.timestampParam = opts.timestampParam || 't';\n  this.timestampRequests = opts.timestampRequests;\n  this.transports = opts.transports || ['polling', 'websocket'];\n  this.readyState = '';\n  this.writeBuffer = [];\n  this.callbackBuffer = [];\n  this.policyPort = opts.policyPort || 843;\n  this.rememberUpgrade = opts.rememberUpgrade || false;\n  this.open();\n  this.binaryType = null;\n  this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;\n}\n\nSocket.priorWebsocketSuccess = false;\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nSocket.protocol = parser.protocol; // this is an int\n\n/**\n * Expose deps for legacy compatibility\n * and standalone browser access.\n */\n\nSocket.Socket = Socket;\nSocket.Transport = _dereq_('./transport');\nSocket.transports = _dereq_('./transports');\nSocket.parser = _dereq_('engine.io-parser');\n\n/**\n * Creates transport of the given type.\n *\n * @param {String} transport name\n * @return {Transport}\n * @api private\n */\n\nSocket.prototype.createTransport = function (name) {\n  debug('creating transport \"%s\"', name);\n  var query = clone(this.query);\n\n  // append engine.io protocol identifier\n  query.EIO = parser.protocol;\n\n  // transport name\n  query.transport = name;\n\n  // session id if we already have one\n  if (this.id) query.sid = this.id;\n\n  var transport = new transports[name]({\n    agent: this.agent,\n    hostname: this.hostname,\n    port: this.port,\n    secure: this.secure,\n    path: this.path,\n    query: query,\n    forceJSONP: this.forceJSONP,\n    jsonp: this.jsonp,\n    forceBase64: this.forceBase64,\n    enablesXDR: this.enablesXDR,\n    timestampRequests: this.timestampRequests,\n    timestampParam: this.timestampParam,\n    policyPort: this.policyPort,\n    socket: this\n  });\n\n  return transport;\n};\n\nfunction clone (obj) {\n  var o = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      o[i] = obj[i];\n    }\n  }\n  return o;\n}\n\n/**\n * Initializes transport to use and starts probe.\n *\n * @api private\n */\nSocket.prototype.open = function () {\n  var transport;\n  if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') != -1) {\n    transport = 'websocket';\n  } else if (0 == this.transports.length) {\n    // Emit error on next tick so it can be listened to\n    var self = this;\n    setTimeout(function() {\n      self.emit('error', 'No transports available');\n    }, 0);\n    return;\n  } else {\n    transport = this.transports[0];\n  }\n  this.readyState = 'opening';\n\n  // Retry with the next transport if the transport is disabled (jsonp: false)\n  var transport;\n  try {\n    transport = this.createTransport(transport);\n  } catch (e) {\n    this.transports.shift();\n    this.open();\n    return;\n  }\n\n  transport.open();\n  this.setTransport(transport);\n};\n\n/**\n * Sets the current transport. Disables the existing one (if any).\n *\n * @api private\n */\n\nSocket.prototype.setTransport = function(transport){\n  debug('setting transport %s', transport.name);\n  var self = this;\n\n  if (this.transport) {\n    debug('clearing existing transport %s', this.transport.name);\n    this.transport.removeAllListeners();\n  }\n\n  // set up transport\n  this.transport = transport;\n\n  // set up transport listeners\n  transport\n  .on('drain', function(){\n    self.onDrain();\n  })\n  .on('packet', function(packet){\n    self.onPacket(packet);\n  })\n  .on('error', function(e){\n    self.onError(e);\n  })\n  .on('close', function(){\n    self.onClose('transport close');\n  });\n};\n\n/**\n * Probes a transport.\n *\n * @param {String} transport name\n * @api private\n */\n\nSocket.prototype.probe = function (name) {\n  debug('probing transport \"%s\"', name);\n  var transport = this.createTransport(name, { probe: 1 })\n    , failed = false\n    , self = this;\n\n  Socket.priorWebsocketSuccess = false;\n\n  function onTransportOpen(){\n    if (self.onlyBinaryUpgrades) {\n      var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;\n      failed = failed || upgradeLosesBinary;\n    }\n    if (failed) return;\n\n    debug('probe transport \"%s\" opened', name);\n    transport.send([{ type: 'ping', data: 'probe' }]);\n    transport.once('packet', function (msg) {\n      if (failed) return;\n      if ('pong' == msg.type && 'probe' == msg.data) {\n        debug('probe transport \"%s\" pong', name);\n        self.upgrading = true;\n        self.emit('upgrading', transport);\n        if (!transport) return;\n        Socket.priorWebsocketSuccess = 'websocket' == transport.name;\n\n        debug('pausing current transport \"%s\"', self.transport.name);\n        self.transport.pause(function () {\n          if (failed) return;\n          if ('closed' == self.readyState) return;\n          debug('changing transport and sending upgrade packet');\n\n          cleanup();\n\n          self.setTransport(transport);\n          transport.send([{ type: 'upgrade' }]);\n          self.emit('upgrade', transport);\n          transport = null;\n          self.upgrading = false;\n          self.flush();\n        });\n      } else {\n        debug('probe transport \"%s\" failed', name);\n        var err = new Error('probe error');\n        err.transport = transport.name;\n        self.emit('upgradeError', err);\n      }\n    });\n  }\n\n  function freezeTransport() {\n    if (failed) return;\n\n    // Any callback called by transport should be ignored since now\n    failed = true;\n\n    cleanup();\n\n    transport.close();\n    transport = null;\n  }\n\n  //Handle any error that happens while probing\n  function onerror(err) {\n    var error = new Error('probe error: ' + err);\n    error.transport = transport.name;\n\n    freezeTransport();\n\n    debug('probe transport \"%s\" failed because of error: %s', name, err);\n\n    self.emit('upgradeError', error);\n  }\n\n  function onTransportClose(){\n    onerror(\"transport closed\");\n  }\n\n  //When the socket is closed while we're probing\n  function onclose(){\n    onerror(\"socket closed\");\n  }\n\n  //When the socket is upgraded while we're probing\n  function onupgrade(to){\n    if (transport && to.name != transport.name) {\n      debug('\"%s\" works - aborting \"%s\"', to.name, transport.name);\n      freezeTransport();\n    }\n  }\n\n  //Remove all listeners on the transport and on self\n  function cleanup(){\n    transport.removeListener('open', onTransportOpen);\n    transport.removeListener('error', onerror);\n    transport.removeListener('close', onTransportClose);\n    self.removeListener('close', onclose);\n    self.removeListener('upgrading', onupgrade);\n  }\n\n  transport.once('open', onTransportOpen);\n  transport.once('error', onerror);\n  transport.once('close', onTransportClose);\n\n  this.once('close', onclose);\n  this.once('upgrading', onupgrade);\n\n  transport.open();\n\n};\n\n/**\n * Called when connection is deemed open.\n *\n * @api public\n */\n\nSocket.prototype.onOpen = function () {\n  debug('socket open');\n  this.readyState = 'open';\n  Socket.priorWebsocketSuccess = 'websocket' == this.transport.name;\n  this.emit('open');\n  this.flush();\n\n  // we check for `readyState` in case an `open`\n  // listener already closed the socket\n  if ('open' == this.readyState && this.upgrade && this.transport.pause) {\n    debug('starting upgrade probes');\n    for (var i = 0, l = this.upgrades.length; i < l; i++) {\n      this.probe(this.upgrades[i]);\n    }\n  }\n};\n\n/**\n * Handles a packet.\n *\n * @api private\n */\n\nSocket.prototype.onPacket = function (packet) {\n  if ('opening' == this.readyState || 'open' == this.readyState) {\n    debug('socket receive: type \"%s\", data \"%s\"', packet.type, packet.data);\n\n    this.emit('packet', packet);\n\n    // Socket is live - any packet counts\n    this.emit('heartbeat');\n\n    switch (packet.type) {\n      case 'open':\n        this.onHandshake(parsejson(packet.data));\n        break;\n\n      case 'pong':\n        this.setPing();\n        break;\n\n      case 'error':\n        var err = new Error('server error');\n        err.code = packet.data;\n        this.emit('error', err);\n        break;\n\n      case 'message':\n        this.emit('data', packet.data);\n        this.emit('message', packet.data);\n        break;\n    }\n  } else {\n    debug('packet received with socket readyState \"%s\"', this.readyState);\n  }\n};\n\n/**\n * Called upon handshake completion.\n *\n * @param {Object} handshake obj\n * @api private\n */\n\nSocket.prototype.onHandshake = function (data) {\n  this.emit('handshake', data);\n  this.id = data.sid;\n  this.transport.query.sid = data.sid;\n  this.upgrades = this.filterUpgrades(data.upgrades);\n  this.pingInterval = data.pingInterval;\n  this.pingTimeout = data.pingTimeout;\n  this.onOpen();\n  // In case open handler closes socket\n  if  ('closed' == this.readyState) return;\n  this.setPing();\n\n  // Prolong liveness of socket on heartbeat\n  this.removeListener('heartbeat', this.onHeartbeat);\n  this.on('heartbeat', this.onHeartbeat);\n};\n\n/**\n * Resets ping timeout.\n *\n * @api private\n */\n\nSocket.prototype.onHeartbeat = function (timeout) {\n  clearTimeout(this.pingTimeoutTimer);\n  var self = this;\n  self.pingTimeoutTimer = setTimeout(function () {\n    if ('closed' == self.readyState) return;\n    self.onClose('ping timeout');\n  }, timeout || (self.pingInterval + self.pingTimeout));\n};\n\n/**\n * Pings server every `this.pingInterval` and expects response\n * within `this.pingTimeout` or closes connection.\n *\n * @api private\n */\n\nSocket.prototype.setPing = function () {\n  var self = this;\n  clearTimeout(self.pingIntervalTimer);\n  self.pingIntervalTimer = setTimeout(function () {\n    debug('writing ping packet - expecting pong within %sms', self.pingTimeout);\n    self.ping();\n    self.onHeartbeat(self.pingTimeout);\n  }, self.pingInterval);\n};\n\n/**\n* Sends a ping packet.\n*\n* @api public\n*/\n\nSocket.prototype.ping = function () {\n  this.sendPacket('ping');\n};\n\n/**\n * Called on `drain` event\n *\n * @api private\n */\n\nSocket.prototype.onDrain = function() {\n  for (var i = 0; i < this.prevBufferLen; i++) {\n    if (this.callbackBuffer[i]) {\n      this.callbackBuffer[i]();\n    }\n  }\n\n  this.writeBuffer.splice(0, this.prevBufferLen);\n  this.callbackBuffer.splice(0, this.prevBufferLen);\n\n  // setting prevBufferLen = 0 is very important\n  // for example, when upgrading, upgrade packet is sent over,\n  // and a nonzero prevBufferLen could cause problems on `drain`\n  this.prevBufferLen = 0;\n\n  if (this.writeBuffer.length == 0) {\n    this.emit('drain');\n  } else {\n    this.flush();\n  }\n};\n\n/**\n * Flush write buffers.\n *\n * @api private\n */\n\nSocket.prototype.flush = function () {\n  if ('closed' != this.readyState && this.transport.writable &&\n    !this.upgrading && this.writeBuffer.length) {\n    debug('flushing %d packets in socket', this.writeBuffer.length);\n    this.transport.send(this.writeBuffer);\n    // keep track of current length of writeBuffer\n    // splice writeBuffer and callbackBuffer on `drain`\n    this.prevBufferLen = this.writeBuffer.length;\n    this.emit('flush');\n  }\n};\n\n/**\n * Sends a message.\n *\n * @param {String} message.\n * @param {Function} callback function.\n * @return {Socket} for chaining.\n * @api public\n */\n\nSocket.prototype.write =\nSocket.prototype.send = function (msg, fn) {\n  this.sendPacket('message', msg, fn);\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {String} packet type.\n * @param {String} data.\n * @param {Function} callback function.\n * @api private\n */\n\nSocket.prototype.sendPacket = function (type, data, fn) {\n  if ('closing' == this.readyState || 'closed' == this.readyState) {\n    return;\n  }\n\n  var packet = { type: type, data: data };\n  this.emit('packetCreate', packet);\n  this.writeBuffer.push(packet);\n  this.callbackBuffer.push(fn);\n  this.flush();\n};\n\n/**\n * Closes the connection.\n *\n * @api private\n */\n\nSocket.prototype.close = function () {\n  if ('opening' == this.readyState || 'open' == this.readyState) {\n    this.readyState = 'closing';\n\n    var self = this;\n\n    function close() {\n      self.onClose('forced close');\n      debug('socket closing - telling transport to close');\n      self.transport.close();\n    }\n\n    function cleanupAndClose() {\n      self.removeListener('upgrade', cleanupAndClose);\n      self.removeListener('upgradeError', cleanupAndClose);\n      close();\n    }\n\n    function waitForUpgrade() {\n      // wait for upgrade to finish since we can't send packets while pausing a transport\n      self.once('upgrade', cleanupAndClose);\n      self.once('upgradeError', cleanupAndClose);\n    }\n\n    if (this.writeBuffer.length) {\n      this.once('drain', function() {\n        if (this.upgrading) {\n          waitForUpgrade();\n        } else {\n          close();\n        }\n      });\n    } else if (this.upgrading) {\n      waitForUpgrade();\n    } else {\n      close();\n    }\n  }\n\n  return this;\n};\n\n/**\n * Called upon transport error\n *\n * @api private\n */\n\nSocket.prototype.onError = function (err) {\n  debug('socket error %j', err);\n  Socket.priorWebsocketSuccess = false;\n  this.emit('error', err);\n  this.onClose('transport error', err);\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nSocket.prototype.onClose = function (reason, desc) {\n  if ('opening' == this.readyState || 'open' == this.readyState || 'closing' == this.readyState) {\n    debug('socket close with reason: \"%s\"', reason);\n    var self = this;\n\n    // clear timers\n    clearTimeout(this.pingIntervalTimer);\n    clearTimeout(this.pingTimeoutTimer);\n\n    // clean buffers in next tick, so developers can still\n    // grab the buffers on `close` event\n    setTimeout(function() {\n      self.writeBuffer = [];\n      self.callbackBuffer = [];\n      self.prevBufferLen = 0;\n    }, 0);\n\n    // stop event from firing again for transport\n    this.transport.removeAllListeners('close');\n\n    // ensure transport won't stay open\n    this.transport.close();\n\n    // ignore further transport communication\n    this.transport.removeAllListeners();\n\n    // set ready state\n    this.readyState = 'closed';\n\n    // clear session id\n    this.id = null;\n\n    // emit close event\n    this.emit('close', reason, desc);\n  }\n};\n\n/**\n * Filters upgrades, returning only those matching client transports.\n *\n * @param {Array} server upgrades\n * @api private\n *\n */\n\nSocket.prototype.filterUpgrades = function (upgrades) {\n  var filteredUpgrades = [];\n  for (var i = 0, j = upgrades.length; i<j; i++) {\n    if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);\n  }\n  return filteredUpgrades;\n};\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./transport\":13,\"./transports\":14,\"component-emitter\":8,\"debug\":21,\"engine.io-parser\":24,\"indexof\":39,\"parsejson\":31,\"parseqs\":32,\"parseuri\":33}],13:[function(_dereq_,module,exports){\n/**\n * Module dependencies.\n */\n\nvar parser = _dereq_('engine.io-parser');\nvar Emitter = _dereq_('component-emitter');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Transport;\n\n/**\n * Transport abstract constructor.\n *\n * @param {Object} options.\n * @api private\n */\n\nfunction Transport (opts) {\n  this.path = opts.path;\n  this.hostname = opts.hostname;\n  this.port = opts.port;\n  this.secure = opts.secure;\n  this.query = opts.query;\n  this.timestampParam = opts.timestampParam;\n  this.timestampRequests = opts.timestampRequests;\n  this.readyState = '';\n  this.agent = opts.agent || false;\n  this.socket = opts.socket;\n  this.enablesXDR = opts.enablesXDR;\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Transport.prototype);\n\n/**\n * A counter used to prevent collisions in the timestamps used\n * for cache busting.\n */\n\nTransport.timestamps = 0;\n\n/**\n * Emits an error.\n *\n * @param {String} str\n * @return {Transport} for chaining\n * @api public\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  var err = new Error(msg);\n  err.type = 'TransportError';\n  err.description = desc;\n  this.emit('error', err);\n  return this;\n};\n\n/**\n * Opens the transport.\n *\n * @api public\n */\n\nTransport.prototype.open = function () {\n  if ('closed' == this.readyState || '' == this.readyState) {\n    this.readyState = 'opening';\n    this.doOpen();\n  }\n\n  return this;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function () {\n  if ('opening' == this.readyState || 'open' == this.readyState) {\n    this.doClose();\n    this.onClose();\n  }\n\n  return this;\n};\n\n/**\n * Sends multiple packets.\n *\n * @param {Array} packets\n * @api private\n */\n\nTransport.prototype.send = function(packets){\n  if ('open' == this.readyState) {\n    this.write(packets);\n  } else {\n    throw new Error('Transport not open');\n  }\n};\n\n/**\n * Called upon open\n *\n * @api private\n */\n\nTransport.prototype.onOpen = function () {\n  this.readyState = 'open';\n  this.writable = true;\n  this.emit('open');\n};\n\n/**\n * Called with data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function(data){\n  var packet = parser.decodePacket(data, this.socket.binaryType);\n  this.onPacket(packet);\n};\n\n/**\n * Called with a decoded packet.\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};\n\n},{\"component-emitter\":8,\"engine.io-parser\":24}],14:[function(_dereq_,module,exports){\n(function (global){\n/**\n * Module dependencies\n */\n\nvar XMLHttpRequest = _dereq_('xmlhttprequest');\nvar XHR = _dereq_('./polling-xhr');\nvar JSONP = _dereq_('./polling-jsonp');\nvar websocket = _dereq_('./websocket');\n\n/**\n * Export transports.\n */\n\nexports.polling = polling;\nexports.websocket = websocket;\n\n/**\n * Polling transport polymorphic constructor.\n * Decides on xhr vs jsonp based on feature detection.\n *\n * @api private\n */\n\nfunction polling(opts){\n  var xhr;\n  var xd = false;\n  var xs = false;\n  var jsonp = false !== opts.jsonp;\n\n  if (global.location) {\n    var isSSL = 'https:' == location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    xd = opts.hostname != location.hostname || port != opts.port;\n    xs = opts.secure != isSSL;\n  }\n\n  opts.xdomain = xd;\n  opts.xscheme = xs;\n  xhr = new XMLHttpRequest(opts);\n\n  if ('open' in xhr && !opts.forceJSONP) {\n    return new XHR(opts);\n  } else {\n    if (!jsonp) throw new Error('JSONP disabled');\n    return new JSONP(opts);\n  }\n}\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./polling-jsonp\":15,\"./polling-xhr\":16,\"./websocket\":18,\"xmlhttprequest\":19}],15:[function(_dereq_,module,exports){\n(function (global){\n\n/**\n * Module requirements.\n */\n\nvar Polling = _dereq_('./polling');\nvar inherit = _dereq_('component-inherit');\n\n/**\n * Module exports.\n */\n\nmodule.exports = JSONPPolling;\n\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n\n/**\n * Callbacks count.\n */\n\nvar index = 0;\n\n/**\n * Noop.\n */\n\nfunction empty () { }\n\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\nfunction JSONPPolling (opts) {\n  Polling.call(this, opts);\n\n  this.query = this.query || {};\n\n  // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    if (!global.___eio) global.___eio = [];\n    callbacks = global.___eio;\n  }\n\n  // callback identifier\n  this.index = callbacks.length;\n\n  // add callback to jsonp global\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  });\n\n  // append to query string\n  this.query.j = this.index;\n\n  // prevent spurious errors from being emitted when the window is unloaded\n  if (global.document && global.addEventListener) {\n    global.addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(JSONPPolling, Polling);\n\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n  script.onerror = function(e){\n    self.onError('jsonp poll error',e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n  insertAt.parentNode.insertBefore(script, insertAt);\n  this.script = script;\n\n  var isUAgecko = 'undefined' != typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete () {\n    initIframe();\n    fn();\n  }\n\n  function initIframe () {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"'+ self.iframeId +'\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe();\n\n  // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch(e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function(){\n      if (self.iframe.readyState == 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./polling\":17,\"component-inherit\":20}],16:[function(_dereq_,module,exports){\n(function (global){\n/**\n * Module requirements.\n */\n\nvar XMLHttpRequest = _dereq_('xmlhttprequest');\nvar Polling = _dereq_('./polling');\nvar Emitter = _dereq_('component-emitter');\nvar inherit = _dereq_('component-inherit');\nvar debug = _dereq_('debug')('engine.io-client:polling-xhr');\n\n/**\n * Module exports.\n */\n\nmodule.exports = XHR;\nmodule.exports.Request = Request;\n\n/**\n * Empty function\n */\n\nfunction empty(){}\n\n/**\n * XHR Polling constructor.\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction XHR(opts){\n  Polling.call(this, opts);\n\n  if (global.location) {\n    var isSSL = 'https:' == location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    this.xd = opts.hostname != global.location.hostname ||\n      port != opts.port;\n    this.xs = opts.secure != isSSL;\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(XHR, Polling);\n\n/**\n * XHR supports binary\n */\n\nXHR.prototype.supportsBinary = true;\n\n/**\n * Creates a request.\n *\n * @param {String} method\n * @api private\n */\n\nXHR.prototype.request = function(opts){\n  opts = opts || {};\n  opts.uri = this.uri();\n  opts.xd = this.xd;\n  opts.xs = this.xs;\n  opts.agent = this.agent || false;\n  opts.supportsBinary = this.supportsBinary;\n  opts.enablesXDR = this.enablesXDR;\n  return new Request(opts);\n};\n\n/**\n * Sends data.\n *\n * @param {String} data to send.\n * @param {Function} called upon flush.\n * @api private\n */\n\nXHR.prototype.doWrite = function(data, fn){\n  var isBinary = typeof data !== 'string' && data !== undefined;\n  var req = this.request({ method: 'POST', data: data, isBinary: isBinary });\n  var self = this;\n  req.on('success', fn);\n  req.on('error', function(err){\n    self.onError('xhr post error', err);\n  });\n  this.sendXhr = req;\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nXHR.prototype.doPoll = function(){\n  debug('xhr poll');\n  var req = this.request();\n  var self = this;\n  req.on('data', function(data){\n    self.onData(data);\n  });\n  req.on('error', function(err){\n    self.onError('xhr poll error', err);\n  });\n  this.pollXhr = req;\n};\n\n/**\n * Request constructor\n *\n * @param {Object} options\n * @api public\n */\n\nfunction Request(opts){\n  this.method = opts.method || 'GET';\n  this.uri = opts.uri;\n  this.xd = !!opts.xd;\n  this.xs = !!opts.xs;\n  this.async = false !== opts.async;\n  this.data = undefined != opts.data ? opts.data : null;\n  this.agent = opts.agent;\n  this.isBinary = opts.isBinary;\n  this.supportsBinary = opts.supportsBinary;\n  this.enablesXDR = opts.enablesXDR;\n  this.create();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Creates the XHR object and sends the request.\n *\n * @api private\n */\n\nRequest.prototype.create = function(){\n  var xhr = this.xhr = new XMLHttpRequest({ agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR });\n  var self = this;\n\n  try {\n    debug('xhr open %s: %s', this.method, this.uri);\n    xhr.open(this.method, this.uri, this.async);\n    if (this.supportsBinary) {\n      // This has to be done after open because Firefox is stupid\n      // http://stackoverflow.com/questions/13216903/get-binary-data-with-xmlhttprequest-in-a-firefox-extension\n      xhr.responseType = 'arraybuffer';\n    }\n\n    if ('POST' == this.method) {\n      try {\n        if (this.isBinary) {\n          xhr.setRequestHeader('Content-type', 'application/octet-stream');\n        } else {\n          xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');\n        }\n      } catch (e) {}\n    }\n\n    // ie6 check\n    if ('withCredentials' in xhr) {\n      xhr.withCredentials = true;\n    }\n\n    if (this.hasXDR()) {\n      xhr.onload = function(){\n        self.onLoad();\n      };\n      xhr.onerror = function(){\n        self.onError(xhr.responseText);\n      };\n    } else {\n      xhr.onreadystatechange = function(){\n        if (4 != xhr.readyState) return;\n        if (200 == xhr.status || 1223 == xhr.status) {\n          self.onLoad();\n        } else {\n          // make sure the `error` event handler that's user-set\n          // does not throw in the same tick and gets caught here\n          setTimeout(function(){\n            self.onError(xhr.status);\n          }, 0);\n        }\n      };\n    }\n\n    debug('xhr data %s', this.data);\n    xhr.send(this.data);\n  } catch (e) {\n    // Need to defer since .create() is called directly fhrom the constructor\n    // and thus the 'error' event can only be only bound *after* this exception\n    // occurs.  Therefore, also, we cannot throw here at all.\n    setTimeout(function() {\n      self.onError(e);\n    }, 0);\n    return;\n  }\n\n  if (global.document) {\n    this.index = Request.requestsCount++;\n    Request.requests[this.index] = this;\n  }\n};\n\n/**\n * Called upon successful response.\n *\n * @api private\n */\n\nRequest.prototype.onSuccess = function(){\n  this.emit('success');\n  this.cleanup();\n};\n\n/**\n * Called if we have data.\n *\n * @api private\n */\n\nRequest.prototype.onData = function(data){\n  this.emit('data', data);\n  this.onSuccess();\n};\n\n/**\n * Called upon error.\n *\n * @api private\n */\n\nRequest.prototype.onError = function(err){\n  this.emit('error', err);\n  this.cleanup();\n};\n\n/**\n * Cleans up house.\n *\n * @api private\n */\n\nRequest.prototype.cleanup = function(){\n  if ('undefined' == typeof this.xhr || null === this.xhr) {\n    return;\n  }\n  // xmlhttprequest\n  if (this.hasXDR()) {\n    this.xhr.onload = this.xhr.onerror = empty;\n  } else {\n    this.xhr.onreadystatechange = empty;\n  }\n\n  try {\n    this.xhr.abort();\n  } catch(e) {}\n\n  if (global.document) {\n    delete Request.requests[this.index];\n  }\n\n  this.xhr = null;\n};\n\n/**\n * Called upon load.\n *\n * @api private\n */\n\nRequest.prototype.onLoad = function(){\n  var data;\n  try {\n    var contentType;\n    try {\n      contentType = this.xhr.getResponseHeader('Content-Type').split(';')[0];\n    } catch (e) {}\n    if (contentType === 'application/octet-stream') {\n      data = this.xhr.response;\n    } else {\n      if (!this.supportsBinary) {\n        data = this.xhr.responseText;\n      } else {\n        data = 'ok';\n      }\n    }\n  } catch (e) {\n    this.onError(e);\n  }\n  if (null != data) {\n    this.onData(data);\n  }\n};\n\n/**\n * Check if it has XDomainRequest.\n *\n * @api private\n */\n\nRequest.prototype.hasXDR = function(){\n  return 'undefined' !== typeof global.XDomainRequest && !this.xs && this.enablesXDR;\n};\n\n/**\n * Aborts the request.\n *\n * @api public\n */\n\nRequest.prototype.abort = function(){\n  this.cleanup();\n};\n\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\n\nif (global.document) {\n  Request.requestsCount = 0;\n  Request.requests = {};\n  if (global.attachEvent) {\n    global.attachEvent('onunload', unloadHandler);\n  } else if (global.addEventListener) {\n    global.addEventListener('beforeunload', unloadHandler, false);\n  }\n}\n\nfunction unloadHandler() {\n  for (var i in Request.requests) {\n    if (Request.requests.hasOwnProperty(i)) {\n      Request.requests[i].abort();\n    }\n  }\n}\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./polling\":17,\"component-emitter\":8,\"component-inherit\":20,\"debug\":21,\"xmlhttprequest\":19}],17:[function(_dereq_,module,exports){\n/**\n * Module dependencies.\n */\n\nvar Transport = _dereq_('../transport');\nvar parseqs = _dereq_('parseqs');\nvar parser = _dereq_('engine.io-parser');\nvar inherit = _dereq_('component-inherit');\nvar debug = _dereq_('debug')('engine.io-client:polling');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Polling;\n\n/**\n * Is XHR2 supported?\n */\n\nvar hasXHR2 = (function() {\n  var XMLHttpRequest = _dereq_('xmlhttprequest');\n  var xhr = new XMLHttpRequest({ xdomain: false });\n  return null != xhr.responseType;\n})();\n\n/**\n * Polling interface.\n *\n * @param {Object} opts\n * @api private\n */\n\nfunction Polling(opts){\n  var forceBase64 = (opts && opts.forceBase64);\n  if (!hasXHR2 || forceBase64) {\n    this.supportsBinary = false;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(Polling, Transport);\n\n/**\n * Transport name.\n */\n\nPolling.prototype.name = 'polling';\n\n/**\n * Opens the socket (triggers polling). We write a PING message to determine\n * when the transport is open.\n *\n * @api private\n */\n\nPolling.prototype.doOpen = function(){\n  this.poll();\n};\n\n/**\n * Pauses polling.\n *\n * @param {Function} callback upon buffers are flushed and transport is paused\n * @api private\n */\n\nPolling.prototype.pause = function(onPause){\n  var pending = 0;\n  var self = this;\n\n  this.readyState = 'pausing';\n\n  function pause(){\n    debug('paused');\n    self.readyState = 'paused';\n    onPause();\n  }\n\n  if (this.polling || !this.writable) {\n    var total = 0;\n\n    if (this.polling) {\n      debug('we are currently polling - waiting to pause');\n      total++;\n      this.once('pollComplete', function(){\n        debug('pre-pause polling complete');\n        --total || pause();\n      });\n    }\n\n    if (!this.writable) {\n      debug('we are currently writing - waiting to pause');\n      total++;\n      this.once('drain', function(){\n        debug('pre-pause writing complete');\n        --total || pause();\n      });\n    }\n  } else {\n    pause();\n  }\n};\n\n/**\n * Starts polling cycle.\n *\n * @api public\n */\n\nPolling.prototype.poll = function(){\n  debug('polling');\n  this.polling = true;\n  this.doPoll();\n  this.emit('poll');\n};\n\n/**\n * Overloads onData to detect payloads.\n *\n * @api private\n */\n\nPolling.prototype.onData = function(data){\n  var self = this;\n  debug('polling got data %s', data);\n  var callback = function(packet, index, total) {\n    // if its the first message we consider the transport open\n    if ('opening' == self.readyState) {\n      self.onOpen();\n    }\n\n    // if its a close packet, we close the ongoing requests\n    if ('close' == packet.type) {\n      self.onClose();\n      return false;\n    }\n\n    // otherwise bypass onData and handle the message\n    self.onPacket(packet);\n  };\n\n  // decode payload\n  parser.decodePayload(data, this.socket.binaryType, callback);\n\n  // if an event did not trigger closing\n  if ('closed' != this.readyState) {\n    // if we got data we're not polling\n    this.polling = false;\n    this.emit('pollComplete');\n\n    if ('open' == this.readyState) {\n      this.poll();\n    } else {\n      debug('ignoring poll - transport state \"%s\"', this.readyState);\n    }\n  }\n};\n\n/**\n * For polling, send a close packet.\n *\n * @api private\n */\n\nPolling.prototype.doClose = function(){\n  var self = this;\n\n  function close(){\n    debug('writing close packet');\n    self.write([{ type: 'close' }]);\n  }\n\n  if ('open' == this.readyState) {\n    debug('transport open - closing');\n    close();\n  } else {\n    // in case we're trying to close while\n    // handshaking is in progress (GH-164)\n    debug('transport not open - deferring close');\n    this.once('open', close);\n  }\n};\n\n/**\n * Writes a packets payload.\n *\n * @param {Array} data packets\n * @param {Function} drain callback\n * @api private\n */\n\nPolling.prototype.write = function(packets){\n  var self = this;\n  this.writable = false;\n  var callbackfn = function() {\n    self.writable = true;\n    self.emit('drain');\n  };\n\n  var self = this;\n  parser.encodePayload(packets, this.supportsBinary, function(data) {\n    self.doWrite(data, callbackfn);\n  });\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nPolling.prototype.uri = function(){\n  var query = this.query || {};\n  var schema = this.secure ? 'https' : 'http';\n  var port = '';\n\n  // cache busting is forced\n  if (false !== this.timestampRequests) {\n    query[this.timestampParam] = +new Date + '-' + Transport.timestamps++;\n  }\n\n  if (!this.supportsBinary && !query.sid) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // avoid port if default for schema\n  if (this.port && (('https' == schema && this.port != 443) ||\n     ('http' == schema && this.port != 80))) {\n    port = ':' + this.port;\n  }\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  return schema + '://' + this.hostname + port + this.path + query;\n};\n\n},{\"../transport\":13,\"component-inherit\":20,\"debug\":21,\"engine.io-parser\":24,\"parseqs\":32,\"xmlhttprequest\":19}],18:[function(_dereq_,module,exports){\n/**\n * Module dependencies.\n */\n\nvar Transport = _dereq_('../transport');\nvar parser = _dereq_('engine.io-parser');\nvar parseqs = _dereq_('parseqs');\nvar inherit = _dereq_('component-inherit');\nvar debug = _dereq_('debug')('engine.io-client:websocket');\n\n/**\n * `ws` exposes a WebSocket-compatible interface in\n * Node, or the `WebSocket` or `MozWebSocket` globals\n * in the browser.\n */\n\nvar WebSocket = _dereq_('ws');\n\n/**\n * Module exports.\n */\n\nmodule.exports = WS;\n\n/**\n * WebSocket transport constructor.\n *\n * @api {Object} connection options\n * @api public\n */\n\nfunction WS(opts){\n  var forceBase64 = (opts && opts.forceBase64);\n  if (forceBase64) {\n    this.supportsBinary = false;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(WS, Transport);\n\n/**\n * Transport name.\n *\n * @api public\n */\n\nWS.prototype.name = 'websocket';\n\n/*\n * WebSockets support binary\n */\n\nWS.prototype.supportsBinary = true;\n\n/**\n * Opens socket.\n *\n * @api private\n */\n\nWS.prototype.doOpen = function(){\n  if (!this.check()) {\n    // let probe timeout\n    return;\n  }\n\n  var self = this;\n  var uri = this.uri();\n  var protocols = void(0);\n  var opts = { agent: this.agent };\n\n  this.ws = new WebSocket(uri, protocols, opts);\n\n  if (this.ws.binaryType === undefined) {\n    this.supportsBinary = false;\n  }\n\n  this.ws.binaryType = 'arraybuffer';\n  this.addEventListeners();\n};\n\n/**\n * Adds event listeners to the socket\n *\n * @api private\n */\n\nWS.prototype.addEventListeners = function(){\n  var self = this;\n\n  this.ws.onopen = function(){\n    self.onOpen();\n  };\n  this.ws.onclose = function(){\n    self.onClose();\n  };\n  this.ws.onmessage = function(ev){\n    self.onData(ev.data);\n  };\n  this.ws.onerror = function(e){\n    self.onError('websocket error', e);\n  };\n};\n\n/**\n * Override `onData` to use a timer on iOS.\n * See: https://gist.github.com/mloughran/2052006\n *\n * @api private\n */\n\nif ('undefined' != typeof navigator\n  && /iPad|iPhone|iPod/i.test(navigator.userAgent)) {\n  WS.prototype.onData = function(data){\n    var self = this;\n    setTimeout(function(){\n      Transport.prototype.onData.call(self, data);\n    }, 0);\n  };\n}\n\n/**\n * Writes data to socket.\n *\n * @param {Array} array of packets.\n * @api private\n */\n\nWS.prototype.write = function(packets){\n  var self = this;\n  this.writable = false;\n  // encodePacket efficient as it uses WS framing\n  // no need for encodePayload\n  for (var i = 0, l = packets.length; i < l; i++) {\n    parser.encodePacket(packets[i], this.supportsBinary, function(data) {\n      //Sometimes the websocket has already been closed but the browser didn't\n      //have a chance of informing us about it yet, in that case send will\n      //throw an error\n      try {\n        self.ws.send(data);\n      } catch (e){\n        debug('websocket closed before onclose event');\n      }\n    });\n  }\n\n  function ondrain() {\n    self.writable = true;\n    self.emit('drain');\n  }\n  // fake drain\n  // defer to next tick to allow Socket to clear writeBuffer\n  setTimeout(ondrain, 0);\n};\n\n/**\n * Called upon close\n *\n * @api private\n */\n\nWS.prototype.onClose = function(){\n  Transport.prototype.onClose.call(this);\n};\n\n/**\n * Closes socket.\n *\n * @api private\n */\n\nWS.prototype.doClose = function(){\n  if (typeof this.ws !== 'undefined') {\n    this.ws.close();\n  }\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nWS.prototype.uri = function(){\n  var query = this.query || {};\n  var schema = this.secure ? 'wss' : 'ws';\n  var port = '';\n\n  // avoid port if default for schema\n  if (this.port && (('wss' == schema && this.port != 443)\n    || ('ws' == schema && this.port != 80))) {\n    port = ':' + this.port;\n  }\n\n  // append timestamp to URI\n  if (this.timestampRequests) {\n    query[this.timestampParam] = +new Date;\n  }\n\n  // communicate binary support capabilities\n  if (!this.supportsBinary) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  return schema + '://' + this.hostname + port + this.path + query;\n};\n\n/**\n * Feature detection for WebSocket.\n *\n * @return {Boolean} whether this transport is available.\n * @api public\n */\n\nWS.prototype.check = function(){\n  return !!WebSocket && !('__initialize' in WebSocket && this.name === WS.prototype.name);\n};\n\n},{\"../transport\":13,\"component-inherit\":20,\"debug\":21,\"engine.io-parser\":24,\"parseqs\":32,\"ws\":34}],19:[function(_dereq_,module,exports){\n// browser shim for xmlhttprequest module\nvar hasCORS = _dereq_('has-cors');\n\nmodule.exports = function(opts) {\n  var xdomain = opts.xdomain;\n\n  // scheme must be same when usign XDomainRequest\n  // http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx\n  var xscheme = opts.xscheme;\n\n  // XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.\n  // https://github.com/Automattic/engine.io-client/pull/217\n  var enablesXDR = opts.enablesXDR;\n\n  // XMLHttpRequest can be disabled on IE\n  try {\n    if ('undefined' != typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n      return new XMLHttpRequest();\n    }\n  } catch (e) { }\n\n  // Use XDomainRequest for IE8 if enablesXDR is true\n  // because loading bar keeps flashing when using jsonp-polling\n  // https://github.com/yujiosaka/socke.io-ie8-loading-example\n  try {\n    if ('undefined' != typeof XDomainRequest && !xscheme && enablesXDR) {\n      return new XDomainRequest();\n    }\n  } catch (e) { }\n\n  if (!xdomain) {\n    try {\n      return new ActiveXObject('Microsoft.XMLHTTP');\n    } catch(e) { }\n  }\n}\n\n},{\"has-cors\":37}],20:[function(_dereq_,module,exports){\n\nmodule.exports = function(a, b){\n  var fn = function(){};\n  fn.prototype = b.prototype;\n  a.prototype = new fn;\n  a.prototype.constructor = a;\n};\n},{}],21:[function(_dereq_,module,exports){\n\n/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = _dereq_('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  'lightseagreen',\n  'forestgreen',\n  'goldenrod',\n  'dodgerblue',\n  'darkorchid',\n  'crimson'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  return ('WebkitAppearance' in document.documentElement.style) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (window.console && (console.firebug || (console.exception && console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31);\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  return JSON.stringify(v);\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs() {\n  var args = arguments;\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return args;\n\n  var c = 'color: ' + this.color;\n  args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-z%]/g, function(match) {\n    if ('%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n  return args;\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // This hackery is required for IE8,\n  // where the `console.log` function doesn't have 'apply'\n  return 'object' == typeof console\n    && 'function' == typeof console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      localStorage.removeItem('debug');\n    } else {\n      localStorage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = localStorage.debug;\n  } catch(e) {}\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n},{\"./debug\":22}],22:[function(_dereq_,module,exports){\n\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = debug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = _dereq_('ms');\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lowercased letter, i.e. \"n\".\n */\n\nexports.formatters = {};\n\n/**\n * Previously assigned color.\n */\n\nvar prevColor = 0;\n\n/**\n * Previous log timestamp.\n */\n\nvar prevTime;\n\n/**\n * Select a color.\n *\n * @return {Number}\n * @api private\n */\n\nfunction selectColor() {\n  return exports.colors[prevColor++ % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction debug(namespace) {\n\n  // define the `disabled` version\n  function disabled() {\n  }\n  disabled.enabled = false;\n\n  // define the `enabled` version\n  function enabled() {\n\n    var self = enabled;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // add the `color` if not set\n    if (null == self.useColors) self.useColors = exports.useColors();\n    if (null == self.color && self.useColors) self.color = selectColor();\n\n    var args = Array.prototype.slice.call(arguments);\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %o\n      args = ['%o'].concat(args);\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    if ('function' === typeof exports.formatArgs) {\n      args = exports.formatArgs.apply(self, args);\n    }\n    var logFn = enabled.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n  enabled.enabled = true;\n\n  var fn = exports.enabled(namespace) ? enabled : disabled;\n\n  fn.namespace = namespace;\n\n  return fn;\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  var split = (namespaces || '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (var i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n\n},{\"ms\":23}],23:[function(_dereq_,module,exports){\n/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} options\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options){\n  options = options || {};\n  if ('string' == typeof val) return parse(val);\n  return options.long\n    ? long(val)\n    : short(val);\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  var match = /^((?:\\d+)?\\.?\\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(str);\n  if (!match) return;\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 's':\n      return n * s;\n    case 'ms':\n      return n;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction short(ms) {\n  if (ms >= d) return Math.round(ms / d) + 'd';\n  if (ms >= h) return Math.round(ms / h) + 'h';\n  if (ms >= m) return Math.round(ms / m) + 'm';\n  if (ms >= s) return Math.round(ms / s) + 's';\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction long(ms) {\n  return plural(ms, d, 'day')\n    || plural(ms, h, 'hour')\n    || plural(ms, m, 'minute')\n    || plural(ms, s, 'second')\n    || ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) return;\n  if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n\n},{}],24:[function(_dereq_,module,exports){\n(function (global){\n/**\n * Module dependencies.\n */\n\nvar keys = _dereq_('./keys');\nvar sliceBuffer = _dereq_('arraybuffer.slice');\nvar base64encoder = _dereq_('base64-arraybuffer');\nvar after = _dereq_('after');\nvar utf8 = _dereq_('utf8');\n\n/**\n * Check if we are running an android browser. That requires us to use\n * ArrayBuffer with polling transports...\n *\n * http://ghinda.net/jpeg-blob-ajax-android/\n */\n\nvar isAndroid = navigator.userAgent.match(/Android/i);\n\n/**\n * Current protocol version.\n */\n\nexports.protocol = 3;\n\n/**\n * Packet types.\n */\n\nvar packets = exports.packets = {\n    open:     0    // non-ws\n  , close:    1    // non-ws\n  , ping:     2\n  , pong:     3\n  , message:  4\n  , upgrade:  5\n  , noop:     6\n};\n\nvar packetslist = keys(packets);\n\n/**\n * Premade error packet.\n */\n\nvar err = { type: 'error', data: 'parser error' };\n\n/**\n * Create a blob api even for blob builder when vendor prefixes exist\n */\n\nvar Blob = _dereq_('blob');\n\n/**\n * Encodes a packet.\n *\n *     <packet type id> [ <data> ]\n *\n * Example:\n *\n *     5hello world\n *     3\n *     4\n *\n * Binary is encoded in an identical principle\n *\n * @api private\n */\n\nexports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {\n  if ('function' == typeof supportsBinary) {\n    callback = supportsBinary;\n    supportsBinary = false;\n  }\n\n  if ('function' == typeof utf8encode) {\n    callback = utf8encode;\n    utf8encode = null;\n  }\n\n  var data = (packet.data === undefined)\n    ? undefined\n    : packet.data.buffer || packet.data;\n\n  if (global.ArrayBuffer && data instanceof ArrayBuffer) {\n    return encodeArrayBuffer(packet, supportsBinary, callback);\n  } else if (Blob && data instanceof global.Blob) {\n    return encodeBlob(packet, supportsBinary, callback);\n  }\n\n  // Sending data as a utf-8 string\n  var encoded = packets[packet.type];\n\n  // data fragment is optional\n  if (undefined !== packet.data) {\n    encoded += utf8encode ? utf8.encode(String(packet.data)) : String(packet.data);\n  }\n\n  return callback('' + encoded);\n\n};\n\n/**\n * Encode packet helpers for binary types\n */\n\nfunction encodeArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var data = packet.data;\n  var contentArray = new Uint8Array(data);\n  var resultBuffer = new Uint8Array(1 + data.byteLength);\n\n  resultBuffer[0] = packets[packet.type];\n  for (var i = 0; i < contentArray.length; i++) {\n    resultBuffer[i+1] = contentArray[i];\n  }\n\n  return callback(resultBuffer.buffer);\n}\n\nfunction encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var fr = new FileReader();\n  fr.onload = function() {\n    packet.data = fr.result;\n    exports.encodePacket(packet, supportsBinary, true, callback);\n  };\n  return fr.readAsArrayBuffer(packet.data);\n}\n\nfunction encodeBlob(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  if (isAndroid) {\n    return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);\n  }\n\n  var length = new Uint8Array(1);\n  length[0] = packets[packet.type];\n  var blob = new Blob([length.buffer, packet.data]);\n\n  return callback(blob);\n}\n\n/**\n * Encodes a packet with binary data in a base64 string\n *\n * @param {Object} packet, has `type` and `data`\n * @return {String} base64 encoded message\n */\n\nexports.encodeBase64Packet = function(packet, callback) {\n  var message = 'b' + exports.packets[packet.type];\n  if (Blob && packet.data instanceof Blob) {\n    var fr = new FileReader();\n    fr.onload = function() {\n      var b64 = fr.result.split(',')[1];\n      callback(message + b64);\n    };\n    return fr.readAsDataURL(packet.data);\n  }\n\n  var b64data;\n  try {\n    b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));\n  } catch (e) {\n    // iPhone Safari doesn't let you apply with typed arrays\n    var typed = new Uint8Array(packet.data);\n    var basic = new Array(typed.length);\n    for (var i = 0; i < typed.length; i++) {\n      basic[i] = typed[i];\n    }\n    b64data = String.fromCharCode.apply(null, basic);\n  }\n  message += global.btoa(b64data);\n  return callback(message);\n};\n\n/**\n * Decodes a packet. Changes format to Blob if requested.\n *\n * @return {Object} with `type` and `data` (if any)\n * @api private\n */\n\nexports.decodePacket = function (data, binaryType, utf8decode) {\n  // String data\n  if (typeof data == 'string' || data === undefined) {\n    if (data.charAt(0) == 'b') {\n      return exports.decodeBase64Packet(data.substr(1), binaryType);\n    }\n\n    if (utf8decode) {\n      try {\n        data = utf8.decode(data);\n      } catch (e) {\n        return err;\n      }\n    }\n    var type = data.charAt(0);\n\n    if (Number(type) != type || !packetslist[type]) {\n      return err;\n    }\n\n    if (data.length > 1) {\n      return { type: packetslist[type], data: data.substring(1) };\n    } else {\n      return { type: packetslist[type] };\n    }\n  }\n\n  var asArray = new Uint8Array(data);\n  var type = asArray[0];\n  var rest = sliceBuffer(data, 1);\n  if (Blob && binaryType === 'blob') {\n    rest = new Blob([rest]);\n  }\n  return { type: packetslist[type], data: rest };\n};\n\n/**\n * Decodes a packet encoded in a base64 string\n *\n * @param {String} base64 encoded message\n * @return {Object} with `type` and `data` (if any)\n */\n\nexports.decodeBase64Packet = function(msg, binaryType) {\n  var type = packetslist[msg.charAt(0)];\n  if (!global.ArrayBuffer) {\n    return { type: type, data: { base64: true, data: msg.substr(1) } };\n  }\n\n  var data = base64encoder.decode(msg.substr(1));\n\n  if (binaryType === 'blob' && Blob) {\n    data = new Blob([data]);\n  }\n\n  return { type: type, data: data };\n};\n\n/**\n * Encodes multiple messages (payload).\n *\n *     <length>:data\n *\n * Example:\n *\n *     11:hello world2:hi\n *\n * If any contents are binary, they will be encoded as base64 strings. Base64\n * encoded strings are marked with a b before the length specifier\n *\n * @param {Array} packets\n * @api private\n */\n\nexports.encodePayload = function (packets, supportsBinary, callback) {\n  if (typeof supportsBinary == 'function') {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  if (supportsBinary) {\n    if (Blob && !isAndroid) {\n      return exports.encodePayloadAsBlob(packets, callback);\n    }\n\n    return exports.encodePayloadAsArrayBuffer(packets, callback);\n  }\n\n  if (!packets.length) {\n    return callback('0:');\n  }\n\n  function setLengthHeader(message) {\n    return message.length + ':' + message;\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, supportsBinary, true, function(message) {\n      doneCallback(null, setLengthHeader(message));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(results.join(''));\n  });\n};\n\n/**\n * Async array map using after\n */\n\nfunction map(ary, each, done) {\n  var result = new Array(ary.length);\n  var next = after(ary.length, done);\n\n  var eachWithIndex = function(i, el, cb) {\n    each(el, function(error, msg) {\n      result[i] = msg;\n      cb(error, result);\n    });\n  };\n\n  for (var i = 0; i < ary.length; i++) {\n    eachWithIndex(i, ary[i], next);\n  }\n}\n\n/*\n * Decodes data when a payload is maybe expected. Possible binary contents are\n * decoded from their base64 representation\n *\n * @param {String} data, callback method\n * @api public\n */\n\nexports.decodePayload = function (data, binaryType, callback) {\n  if (typeof data != 'string') {\n    return exports.decodePayloadAsBinary(data, binaryType, callback);\n  }\n\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var packet;\n  if (data == '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n  var length = ''\n    , n, msg;\n\n  for (var i = 0, l = data.length; i < l; i++) {\n    var chr = data.charAt(i);\n\n    if (':' != chr) {\n      length += chr;\n    } else {\n      if ('' == length || (length != (n = Number(length)))) {\n        // parser error - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      msg = data.substr(i + 1, n);\n\n      if (length != msg.length) {\n        // parser error - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      if (msg.length) {\n        packet = exports.decodePacket(msg, binaryType, true);\n\n        if (err.type == packet.type && err.data == packet.data) {\n          // parser error in individual packet - ignoring payload\n          return callback(err, 0, 1);\n        }\n\n        var ret = callback(packet, i + n, l);\n        if (false === ret) return;\n      }\n\n      // advance cursor\n      i += n;\n      length = '';\n    }\n  }\n\n  if (length != '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n};\n\n/**\n * Encodes multiple messages (payload) as binary.\n *\n * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number\n * 255><data>\n *\n * Example:\n * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers\n *\n * @param {Array} packets\n * @return {ArrayBuffer} encoded payload\n * @api private\n */\n\nexports.encodePayloadAsArrayBuffer = function(packets, callback) {\n  if (!packets.length) {\n    return callback(new ArrayBuffer(0));\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(data) {\n      return doneCallback(null, data);\n    });\n  }\n\n  map(packets, encodeOne, function(err, encodedPackets) {\n    var totalLength = encodedPackets.reduce(function(acc, p) {\n      var len;\n      if (typeof p === 'string'){\n        len = p.length;\n      } else {\n        len = p.byteLength;\n      }\n      return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2\n    }, 0);\n\n    var resultArray = new Uint8Array(totalLength);\n\n    var bufferIndex = 0;\n    encodedPackets.forEach(function(p) {\n      var isString = typeof p === 'string';\n      var ab = p;\n      if (isString) {\n        var view = new Uint8Array(p.length);\n        for (var i = 0; i < p.length; i++) {\n          view[i] = p.charCodeAt(i);\n        }\n        ab = view.buffer;\n      }\n\n      if (isString) { // not true binary\n        resultArray[bufferIndex++] = 0;\n      } else { // true binary\n        resultArray[bufferIndex++] = 1;\n      }\n\n      var lenStr = ab.byteLength.toString();\n      for (var i = 0; i < lenStr.length; i++) {\n        resultArray[bufferIndex++] = parseInt(lenStr[i]);\n      }\n      resultArray[bufferIndex++] = 255;\n\n      var view = new Uint8Array(ab);\n      for (var i = 0; i < view.length; i++) {\n        resultArray[bufferIndex++] = view[i];\n      }\n    });\n\n    return callback(resultArray.buffer);\n  });\n};\n\n/**\n * Encode as Blob\n */\n\nexports.encodePayloadAsBlob = function(packets, callback) {\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(encoded) {\n      var binaryIdentifier = new Uint8Array(1);\n      binaryIdentifier[0] = 1;\n      if (typeof encoded === 'string') {\n        var view = new Uint8Array(encoded.length);\n        for (var i = 0; i < encoded.length; i++) {\n          view[i] = encoded.charCodeAt(i);\n        }\n        encoded = view.buffer;\n        binaryIdentifier[0] = 0;\n      }\n\n      var len = (encoded instanceof ArrayBuffer)\n        ? encoded.byteLength\n        : encoded.size;\n\n      var lenStr = len.toString();\n      var lengthAry = new Uint8Array(lenStr.length + 1);\n      for (var i = 0; i < lenStr.length; i++) {\n        lengthAry[i] = parseInt(lenStr[i]);\n      }\n      lengthAry[lenStr.length] = 255;\n\n      if (Blob) {\n        var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);\n        doneCallback(null, blob);\n      }\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(new Blob(results));\n  });\n};\n\n/*\n * Decodes data when a payload is maybe expected. Strings are decoded by\n * interpreting each byte as a key code for entries marked to start with 0. See\n * description of encodePayloadAsBinary\n *\n * @param {ArrayBuffer} data, callback method\n * @api public\n */\n\nexports.decodePayloadAsBinary = function (data, binaryType, callback) {\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var bufferTail = data;\n  var buffers = [];\n\n  var numberTooLong = false;\n  while (bufferTail.byteLength > 0) {\n    var tailArray = new Uint8Array(bufferTail);\n    var isString = tailArray[0] === 0;\n    var msgLength = '';\n\n    for (var i = 1; ; i++) {\n      if (tailArray[i] == 255) break;\n\n      if (msgLength.length > 310) {\n        numberTooLong = true;\n        break;\n      }\n\n      msgLength += tailArray[i];\n    }\n\n    if(numberTooLong) return callback(err, 0, 1);\n\n    bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);\n    msgLength = parseInt(msgLength);\n\n    var msg = sliceBuffer(bufferTail, 0, msgLength);\n    if (isString) {\n      try {\n        msg = String.fromCharCode.apply(null, new Uint8Array(msg));\n      } catch (e) {\n        // iPhone Safari doesn't let you apply to typed arrays\n        var typed = new Uint8Array(msg);\n        msg = '';\n        for (var i = 0; i < typed.length; i++) {\n          msg += String.fromCharCode(typed[i]);\n        }\n      }\n    }\n\n    buffers.push(msg);\n    bufferTail = sliceBuffer(bufferTail, msgLength);\n  }\n\n  var total = buffers.length;\n  buffers.forEach(function(buffer, i) {\n    callback(exports.decodePacket(buffer, binaryType, true), i, total);\n  });\n};\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./keys\":25,\"after\":26,\"arraybuffer.slice\":27,\"base64-arraybuffer\":28,\"blob\":29,\"utf8\":30}],25:[function(_dereq_,module,exports){\n\n/**\n * Gets the keys for an object.\n *\n * @return {Array} keys\n * @api private\n */\n\nmodule.exports = Object.keys || function keys (obj){\n  var arr = [];\n  var has = Object.prototype.hasOwnProperty;\n\n  for (var i in obj) {\n    if (has.call(obj, i)) {\n      arr.push(i);\n    }\n  }\n  return arr;\n};\n\n},{}],26:[function(_dereq_,module,exports){\nmodule.exports = after\n\nfunction after(count, callback, err_cb) {\n    var bail = false\n    err_cb = err_cb || noop\n    proxy.count = count\n\n    return (count === 0) ? callback() : proxy\n\n    function proxy(err, result) {\n        if (proxy.count <= 0) {\n            throw new Error('after called too many times')\n        }\n        --proxy.count\n\n        // after first error, rest are passed to err_cb\n        if (err) {\n            bail = true\n            callback(err)\n            // future error callbacks will go to error handler\n            callback = err_cb\n        } else if (proxy.count === 0 && !bail) {\n            callback(null, result)\n        }\n    }\n}\n\nfunction noop() {}\n\n},{}],27:[function(_dereq_,module,exports){\n/**\n * An abstraction for slicing an arraybuffer even when\n * ArrayBuffer.prototype.slice is not supported\n *\n * @api public\n */\n\nmodule.exports = function(arraybuffer, start, end) {\n  var bytes = arraybuffer.byteLength;\n  start = start || 0;\n  end = end || bytes;\n\n  if (arraybuffer.slice) { return arraybuffer.slice(start, end); }\n\n  if (start < 0) { start += bytes; }\n  if (end < 0) { end += bytes; }\n  if (end > bytes) { end = bytes; }\n\n  if (start >= bytes || start >= end || bytes === 0) {\n    return new ArrayBuffer(0);\n  }\n\n  var abv = new Uint8Array(arraybuffer);\n  var result = new Uint8Array(end - start);\n  for (var i = start, ii = 0; i < end; i++, ii++) {\n    result[ii] = abv[i];\n  }\n  return result.buffer;\n};\n\n},{}],28:[function(_dereq_,module,exports){\n/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(chars){\n  \"use strict\";\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = chars.indexOf(base64[i]);\n      encoded2 = chars.indexOf(base64[i+1]);\n      encoded3 = chars.indexOf(base64[i+2]);\n      encoded4 = chars.indexOf(base64[i+3]);\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\");\n\n},{}],29:[function(_dereq_,module,exports){\n(function (global){\n/**\n * Create a blob builder even when vendor prefixes exist\n */\n\nvar BlobBuilder = global.BlobBuilder\n  || global.WebKitBlobBuilder\n  || global.MSBlobBuilder\n  || global.MozBlobBuilder;\n\n/**\n * Check if Blob constructor is supported\n */\n\nvar blobSupported = (function() {\n  try {\n    var b = new Blob(['hi']);\n    return b.size == 2;\n  } catch(e) {\n    return false;\n  }\n})();\n\n/**\n * Check if BlobBuilder is supported\n */\n\nvar blobBuilderSupported = BlobBuilder\n  && BlobBuilder.prototype.append\n  && BlobBuilder.prototype.getBlob;\n\nfunction BlobBuilderConstructor(ary, options) {\n  options = options || {};\n\n  var bb = new BlobBuilder();\n  for (var i = 0; i < ary.length; i++) {\n    bb.append(ary[i]);\n  }\n  return (options.type) ? bb.getBlob(options.type) : bb.getBlob();\n};\n\nmodule.exports = (function() {\n  if (blobSupported) {\n    return global.Blob;\n  } else if (blobBuilderSupported) {\n    return BlobBuilderConstructor;\n  } else {\n    return undefined;\n  }\n})();\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],30:[function(_dereq_,module,exports){\n(function (global){\n/*! http://mths.be/utf8js v2.0.0 by @mathias */\n;(function(root) {\n\n\t// Detect free variables `exports`\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code,\n\t// and use it as `root`\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar stringFromCharCode = String.fromCharCode;\n\n\t// Taken from http://mths.be/punycode\n\tfunction ucs2decode(string) {\n\t\tvar output = [];\n\t\tvar counter = 0;\n\t\tvar length = string.length;\n\t\tvar value;\n\t\tvar extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t// Taken from http://mths.be/punycode\n\tfunction ucs2encode(array) {\n\t\tvar length = array.length;\n\t\tvar index = -1;\n\t\tvar value;\n\t\tvar output = '';\n\t\twhile (++index < length) {\n\t\t\tvalue = array[index];\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t}\n\t\treturn output;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tfunction createByte(codePoint, shift) {\n\t\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n\t}\n\n\tfunction encodeCodePoint(codePoint) {\n\t\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\t\treturn stringFromCharCode(codePoint);\n\t\t}\n\t\tvar symbol = '';\n\t\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t\t}\n\t\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\t\tsymbol += createByte(codePoint, 6);\n\t\t}\n\t\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\t\tsymbol += createByte(codePoint, 12);\n\t\t\tsymbol += createByte(codePoint, 6);\n\t\t}\n\t\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\t\treturn symbol;\n\t}\n\n\tfunction utf8encode(string) {\n\t\tvar codePoints = ucs2decode(string);\n\n\t\t// console.log(JSON.stringify(codePoints.map(function(x) {\n\t\t// \treturn 'U+' + x.toString(16).toUpperCase();\n\t\t// })));\n\n\t\tvar length = codePoints.length;\n\t\tvar index = -1;\n\t\tvar codePoint;\n\t\tvar byteString = '';\n\t\twhile (++index < length) {\n\t\t\tcodePoint = codePoints[index];\n\t\t\tbyteString += encodeCodePoint(codePoint);\n\t\t}\n\t\treturn byteString;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tfunction readContinuationByte() {\n\t\tif (byteIndex >= byteCount) {\n\t\t\tthrow Error('Invalid byte index');\n\t\t}\n\n\t\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\t\tbyteIndex++;\n\n\t\tif ((continuationByte & 0xC0) == 0x80) {\n\t\t\treturn continuationByte & 0x3F;\n\t\t}\n\n\t\t// If we end up here, it’s not a continuation byte\n\t\tthrow Error('Invalid continuation byte');\n\t}\n\n\tfunction decodeSymbol() {\n\t\tvar byte1;\n\t\tvar byte2;\n\t\tvar byte3;\n\t\tvar byte4;\n\t\tvar codePoint;\n\n\t\tif (byteIndex > byteCount) {\n\t\t\tthrow Error('Invalid byte index');\n\t\t}\n\n\t\tif (byteIndex == byteCount) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Read first byte\n\t\tbyte1 = byteArray[byteIndex] & 0xFF;\n\t\tbyteIndex++;\n\n\t\t// 1-byte sequence (no continuation bytes)\n\t\tif ((byte1 & 0x80) == 0) {\n\t\t\treturn byte1;\n\t\t}\n\n\t\t// 2-byte sequence\n\t\tif ((byte1 & 0xE0) == 0xC0) {\n\t\t\tvar byte2 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\t\tif (codePoint >= 0x80) {\n\t\t\t\treturn codePoint;\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid continuation byte');\n\t\t\t}\n\t\t}\n\n\t\t// 3-byte sequence (may include unpaired surrogates)\n\t\tif ((byte1 & 0xF0) == 0xE0) {\n\t\t\tbyte2 = readContinuationByte();\n\t\t\tbyte3 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\t\tif (codePoint >= 0x0800) {\n\t\t\t\treturn codePoint;\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid continuation byte');\n\t\t\t}\n\t\t}\n\n\t\t// 4-byte sequence\n\t\tif ((byte1 & 0xF8) == 0xF0) {\n\t\t\tbyte2 = readContinuationByte();\n\t\t\tbyte3 = readContinuationByte();\n\t\t\tbyte4 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x0F) << 0x12) | (byte2 << 0x0C) |\n\t\t\t\t(byte3 << 0x06) | byte4;\n\t\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\t\treturn codePoint;\n\t\t\t}\n\t\t}\n\n\t\tthrow Error('Invalid UTF-8 detected');\n\t}\n\n\tvar byteArray;\n\tvar byteCount;\n\tvar byteIndex;\n\tfunction utf8decode(byteString) {\n\t\tbyteArray = ucs2decode(byteString);\n\t\tbyteCount = byteArray.length;\n\t\tbyteIndex = 0;\n\t\tvar codePoints = [];\n\t\tvar tmp;\n\t\twhile ((tmp = decodeSymbol()) !== false) {\n\t\t\tcodePoints.push(tmp);\n\t\t}\n\t\treturn ucs2encode(codePoints);\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar utf8 = {\n\t\t'version': '2.0.0',\n\t\t'encode': utf8encode,\n\t\t'decode': utf8decode\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn utf8;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = utf8;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tvar object = {};\n\t\t\tvar hasOwnProperty = object.hasOwnProperty;\n\t\t\tfor (var key in utf8) {\n\t\t\t\thasOwnProperty.call(utf8, key) && (freeExports[key] = utf8[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.utf8 = utf8;\n\t}\n\n}(this));\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],31:[function(_dereq_,module,exports){\n(function (global){\n/**\n * JSON parse.\n *\n * @see Based on jQuery#parseJSON (MIT) and JSON2\n * @api private\n */\n\nvar rvalidchars = /^[\\],:{}\\s]*$/;\nvar rvalidescape = /\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g;\nvar rvalidtokens = /\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g;\nvar rvalidbraces = /(?:^|:|,)(?:\\s*\\[)+/g;\nvar rtrimLeft = /^\\s+/;\nvar rtrimRight = /\\s+$/;\n\nmodule.exports = function parsejson(data) {\n  if ('string' != typeof data || !data) {\n    return null;\n  }\n\n  data = data.replace(rtrimLeft, '').replace(rtrimRight, '');\n\n  // Attempt to parse using the native JSON parser first\n  if (global.JSON && JSON.parse) {\n    return JSON.parse(data);\n  }\n\n  if (rvalidchars.test(data.replace(rvalidescape, '@')\n      .replace(rvalidtokens, ']')\n      .replace(rvalidbraces, ''))) {\n    return (new Function('return ' + data))();\n  }\n};\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],32:[function(_dereq_,module,exports){\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\n\nexports.encode = function (obj) {\n  var str = '';\n\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (str.length) str += '&';\n      str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n    }\n  }\n\n  return str;\n};\n\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\n\nexports.decode = function(qs){\n  var qry = {};\n  var pairs = qs.split('&');\n  for (var i = 0, l = pairs.length; i < l; i++) {\n    var pair = pairs[i].split('=');\n    qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n  }\n  return qry;\n};\n\n},{}],33:[function(_dereq_,module,exports){\n/**\n * Parses an URI\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\n\nvar re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\n\nvar parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\n\nmodule.exports = function parseuri(str) {\n    var src = str,\n        b = str.indexOf('['),\n        e = str.indexOf(']');\n\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n\n    var m = re.exec(str || ''),\n        uri = {},\n        i = 14;\n\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n\n    return uri;\n};\n\n},{}],34:[function(_dereq_,module,exports){\n\n/**\n * Module dependencies.\n */\n\nvar global = (function() { return this; })();\n\n/**\n * WebSocket constructor.\n */\n\nvar WebSocket = global.WebSocket || global.MozWebSocket;\n\n/**\n * Module exports.\n */\n\nmodule.exports = WebSocket ? ws : null;\n\n/**\n * WebSocket constructor.\n *\n * The third `opts` options object gets ignored in web browsers, since it's\n * non-standard, and throws a TypeError if passed to the constructor.\n * See: https://github.com/einaros/ws/issues/227\n *\n * @param {String} uri\n * @param {Array} protocols (optional)\n * @param {Object) opts (optional)\n * @api public\n */\n\nfunction ws(uri, protocols, opts) {\n  var instance;\n  if (protocols) {\n    instance = new WebSocket(uri, protocols);\n  } else {\n    instance = new WebSocket(uri);\n  }\n  return instance;\n}\n\nif (WebSocket) ws.prototype = WebSocket.prototype;\n\n},{}],35:[function(_dereq_,module,exports){\n(function (global){\n\n/*\n * Module requirements.\n */\n\nvar isArray = _dereq_('isarray');\n\n/**\n * Module exports.\n */\n\nmodule.exports = hasBinary;\n\n/**\n * Checks for binary data.\n *\n * Right now only Buffer and ArrayBuffer are supported..\n *\n * @param {Object} anything\n * @api public\n */\n\nfunction hasBinary(data) {\n\n  function _hasBinary(obj) {\n    if (!obj) return false;\n\n    if ( (global.Buffer && global.Buffer.isBuffer(obj)) ||\n         (global.ArrayBuffer && obj instanceof ArrayBuffer) ||\n         (global.Blob && obj instanceof Blob) ||\n         (global.File && obj instanceof File)\n        ) {\n      return true;\n    }\n\n    if (isArray(obj)) {\n      for (var i = 0; i < obj.length; i++) {\n          if (_hasBinary(obj[i])) {\n              return true;\n          }\n      }\n    } else if (obj && 'object' == typeof obj) {\n      if (obj.toJSON) {\n        obj = obj.toJSON();\n      }\n\n      for (var key in obj) {\n        if (obj.hasOwnProperty(key) && _hasBinary(obj[key])) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  return _hasBinary(data);\n}\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"isarray\":36}],36:[function(_dereq_,module,exports){\nmodule.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n\n},{}],37:[function(_dereq_,module,exports){\n\n/**\n * Module dependencies.\n */\n\nvar global = _dereq_('global');\n\n/**\n * Module exports.\n *\n * Logic borrowed from Modernizr:\n *\n *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js\n */\n\ntry {\n  module.exports = 'XMLHttpRequest' in global &&\n    'withCredentials' in new global.XMLHttpRequest();\n} catch (err) {\n  // if XMLHttp support is disabled in IE then it will throw\n  // when trying to create\n  module.exports = false;\n}\n\n},{\"global\":38}],38:[function(_dereq_,module,exports){\n\n/**\n * Returns `this`. Execute this without a \"context\" (i.e. without it being\n * attached to an object of the left-hand side), and `this` points to the\n * \"global\" scope of the current JS execution.\n */\n\nmodule.exports = (function () { return this; })();\n\n},{}],39:[function(_dereq_,module,exports){\n\nvar indexOf = [].indexOf;\n\nmodule.exports = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};\n},{}],40:[function(_dereq_,module,exports){\n\n/**\n * HOP ref.\n */\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Return own keys in `obj`.\n *\n * @param {Object} obj\n * @return {Array}\n * @api public\n */\n\nexports.keys = Object.keys || function(obj){\n  var keys = [];\n  for (var key in obj) {\n    if (has.call(obj, key)) {\n      keys.push(key);\n    }\n  }\n  return keys;\n};\n\n/**\n * Return own values in `obj`.\n *\n * @param {Object} obj\n * @return {Array}\n * @api public\n */\n\nexports.values = function(obj){\n  var vals = [];\n  for (var key in obj) {\n    if (has.call(obj, key)) {\n      vals.push(obj[key]);\n    }\n  }\n  return vals;\n};\n\n/**\n * Merge `b` into `a`.\n *\n * @param {Object} a\n * @param {Object} b\n * @return {Object} a\n * @api public\n */\n\nexports.merge = function(a, b){\n  for (var key in b) {\n    if (has.call(b, key)) {\n      a[key] = b[key];\n    }\n  }\n  return a;\n};\n\n/**\n * Return length of `obj`.\n *\n * @param {Object} obj\n * @return {Number}\n * @api public\n */\n\nexports.length = function(obj){\n  return exports.keys(obj).length;\n};\n\n/**\n * Check if `obj` is empty.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api public\n */\n\nexports.isEmpty = function(obj){\n  return 0 == exports.length(obj);\n};\n},{}],41:[function(_dereq_,module,exports){\n/**\n * Parses an URI\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\n\nvar re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\n\nvar parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host'\n  , 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\n\nmodule.exports = function parseuri(str) {\n  var m = re.exec(str || '')\n    , uri = {}\n    , i = 14;\n\n  while (i--) {\n    uri[parts[i]] = m[i] || '';\n  }\n\n  return uri;\n};\n\n},{}],42:[function(_dereq_,module,exports){\n(function (global){\n/*global Blob,File*/\n\n/**\n * Module requirements\n */\n\nvar isArray = _dereq_('isarray');\nvar isBuf = _dereq_('./is-buffer');\n\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function(packet){\n  var buffers = [];\n  var packetData = packet.data;\n\n  function _deconstructPacket(data) {\n    if (!data) return data;\n\n    if (isBuf(data)) {\n      var placeholder = { _placeholder: true, num: buffers.length };\n      buffers.push(data);\n      return placeholder;\n    } else if (isArray(data)) {\n      var newData = new Array(data.length);\n      for (var i = 0; i < data.length; i++) {\n        newData[i] = _deconstructPacket(data[i]);\n      }\n      return newData;\n    } else if ('object' == typeof data && !(data instanceof Date)) {\n      var newData = {};\n      for (var key in data) {\n        newData[key] = _deconstructPacket(data[key]);\n      }\n      return newData;\n    }\n    return data;\n  }\n\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n  return {packet: pack, buffers: buffers};\n};\n\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\nexports.reconstructPacket = function(packet, buffers) {\n  var curPlaceHolder = 0;\n\n  function _reconstructPacket(data) {\n    if (data && data._placeholder) {\n      var buf = buffers[data.num]; // appropriate buffer (should be natural order anyway)\n      return buf;\n    } else if (isArray(data)) {\n      for (var i = 0; i < data.length; i++) {\n        data[i] = _reconstructPacket(data[i]);\n      }\n      return data;\n    } else if (data && 'object' == typeof data) {\n      for (var key in data) {\n        data[key] = _reconstructPacket(data[key]);\n      }\n      return data;\n    }\n    return data;\n  }\n\n  packet.data = _reconstructPacket(packet.data);\n  packet.attachments = undefined; // no longer useful\n  return packet;\n};\n\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\nexports.removeBlobs = function(data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj;\n\n    // convert any blob\n    if ((global.Blob && obj instanceof Blob) ||\n        (global.File && obj instanceof File)) {\n      pendingBlobs++;\n\n      // async filereader\n      var fileReader = new FileReader();\n      fileReader.onload = function() { // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        }\n        else {\n          bloblessData = this.result;\n        }\n\n        // if nothing pending its callback time\n        if(! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) { // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (obj && 'object' == typeof obj && !isBuf(obj)) { // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n  _removeBlobs(bloblessData);\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./is-buffer\":44,\"isarray\":45}],43:[function(_dereq_,module,exports){\n\n/**\n * Module dependencies.\n */\n\nvar debug = _dereq_('debug')('socket.io-parser');\nvar json = _dereq_('json3');\nvar isArray = _dereq_('isarray');\nvar Emitter = _dereq_('component-emitter');\nvar binary = _dereq_('./binary');\nvar isBuf = _dereq_('./is-buffer');\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = 4;\n\n/**\n * Packet types.\n *\n * @api public\n */\n\nexports.types = [\n  'CONNECT',\n  'DISCONNECT',\n  'EVENT',\n  'BINARY_EVENT',\n  'ACK',\n  'BINARY_ACK',\n  'ERROR'\n];\n\n/**\n * Packet type `connect`.\n *\n * @api public\n */\n\nexports.CONNECT = 0;\n\n/**\n * Packet type `disconnect`.\n *\n * @api public\n */\n\nexports.DISCONNECT = 1;\n\n/**\n * Packet type `event`.\n *\n * @api public\n */\n\nexports.EVENT = 2;\n\n/**\n * Packet type `ack`.\n *\n * @api public\n */\n\nexports.ACK = 3;\n\n/**\n * Packet type `error`.\n *\n * @api public\n */\n\nexports.ERROR = 4;\n\n/**\n * Packet type 'binary event'\n *\n * @api public\n */\n\nexports.BINARY_EVENT = 5;\n\n/**\n * Packet type `binary ack`. For acks with binary arguments.\n *\n * @api public\n */\n\nexports.BINARY_ACK = 6;\n\n/**\n * Encoder constructor.\n *\n * @api public\n */\n\nexports.Encoder = Encoder;\n\n/**\n * Decoder constructor.\n *\n * @api public\n */\n\nexports.Decoder = Decoder;\n\n/**\n * A socket.io Encoder instance\n *\n * @api public\n */\n\nfunction Encoder() {}\n\n/**\n * Encode a packet as a single string if non-binary, or as a\n * buffer sequence, depending on packet type.\n *\n * @param {Object} obj - packet object\n * @param {Function} callback - function to handle encodings (likely engine.write)\n * @return Calls callback with Array of encodings\n * @api public\n */\n\nEncoder.prototype.encode = function(obj, callback){\n  debug('encoding packet %j', obj);\n\n  if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {\n    encodeAsBinary(obj, callback);\n  }\n  else {\n    var encoding = encodeAsString(obj);\n    callback([encoding]);\n  }\n};\n\n/**\n * Encode packet as string.\n *\n * @param {Object} packet\n * @return {String} encoded\n * @api private\n */\n\nfunction encodeAsString(obj) {\n  var str = '';\n  var nsp = false;\n\n  // first is type\n  str += obj.type;\n\n  // attachments if we have them\n  if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {\n    str += obj.attachments;\n    str += '-';\n  }\n\n  // if we have a namespace other than `/`\n  // we append it followed by a comma `,`\n  if (obj.nsp && '/' != obj.nsp) {\n    nsp = true;\n    str += obj.nsp;\n  }\n\n  // immediately followed by the id\n  if (null != obj.id) {\n    if (nsp) {\n      str += ',';\n      nsp = false;\n    }\n    str += obj.id;\n  }\n\n  // json data\n  if (null != obj.data) {\n    if (nsp) str += ',';\n    str += json.stringify(obj.data);\n  }\n\n  debug('encoded %j as %s', obj, str);\n  return str;\n}\n\n/**\n * Encode packet as 'buffer sequence' by removing blobs, and\n * deconstructing packet into object with placeholders and\n * a list of buffers.\n *\n * @param {Object} packet\n * @return {Buffer} encoded\n * @api private\n */\n\nfunction encodeAsBinary(obj, callback) {\n\n  function writeEncoding(bloblessData) {\n    var deconstruction = binary.deconstructPacket(bloblessData);\n    var pack = encodeAsString(deconstruction.packet);\n    var buffers = deconstruction.buffers;\n\n    buffers.unshift(pack); // add packet info to beginning of data list\n    callback(buffers); // write all the buffers\n  }\n\n  binary.removeBlobs(obj, writeEncoding);\n}\n\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n * @api public\n */\n\nfunction Decoder() {\n  this.reconstructor = null;\n}\n\n/**\n * Mix in `Emitter` with Decoder.\n */\n\nEmitter(Decoder.prototype);\n\n/**\n * Decodes an ecoded packet string into packet JSON.\n *\n * @param {String} obj - encoded packet\n * @return {Object} packet\n * @api public\n */\n\nDecoder.prototype.add = function(obj) {\n  var packet;\n  if ('string' == typeof obj) {\n    packet = decodeString(obj);\n    if (exports.BINARY_EVENT == packet.type || exports.BINARY_ACK == packet.type) { // binary packet's json\n      this.reconstructor = new BinaryReconstructor(packet);\n\n      // no attachments, labeled binary but no binary data to follow\n      if (this.reconstructor.reconPack.attachments == 0) {\n        this.emit('decoded', packet);\n      }\n    } else { // non-binary full packet\n      this.emit('decoded', packet);\n    }\n  }\n  else if (isBuf(obj) || obj.base64) { // raw binary data\n    if (!this.reconstructor) {\n      throw new Error('got binary data when not reconstructing a packet');\n    } else {\n      packet = this.reconstructor.takeBinaryData(obj);\n      if (packet) { // received final buffer\n        this.reconstructor = null;\n        this.emit('decoded', packet);\n      }\n    }\n  }\n  else {\n    throw new Error('Unknown type: ' + obj);\n  }\n};\n\n/**\n * Decode a packet String (JSON data)\n *\n * @param {String} str\n * @return {Object} packet\n * @api private\n */\n\nfunction decodeString(str) {\n  var p = {};\n  var i = 0;\n\n  // look up type\n  p.type = Number(str.charAt(0));\n  if (null == exports.types[p.type]) return error();\n\n  // look up attachments if type binary\n  if (exports.BINARY_EVENT == p.type || exports.BINARY_ACK == p.type) {\n    p.attachments = '';\n    while (str.charAt(++i) != '-') {\n      p.attachments += str.charAt(i);\n    }\n    p.attachments = Number(p.attachments);\n  }\n\n  // look up namespace (if any)\n  if ('/' == str.charAt(i + 1)) {\n    p.nsp = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (',' == c) break;\n      p.nsp += c;\n      if (i + 1 == str.length) break;\n    }\n  } else {\n    p.nsp = '/';\n  }\n\n  // look up id\n  var next = str.charAt(i + 1);\n  if ('' != next && Number(next) == next) {\n    p.id = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (null == c || Number(c) != c) {\n        --i;\n        break;\n      }\n      p.id += str.charAt(i);\n      if (i + 1 == str.length) break;\n    }\n    p.id = Number(p.id);\n  }\n\n  // look up json data\n  if (str.charAt(++i)) {\n    try {\n      p.data = json.parse(str.substr(i));\n    } catch(e){\n      return error();\n    }\n  }\n\n  debug('decoded %s as %j', str, p);\n  return p;\n}\n\n/**\n * Deallocates a parser's resources\n *\n * @api public\n */\n\nDecoder.prototype.destroy = function() {\n  if (this.reconstructor) {\n    this.reconstructor.finishedReconstruction();\n  }\n};\n\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n * @api private\n */\n\nfunction BinaryReconstructor(packet) {\n  this.reconPack = packet;\n  this.buffers = [];\n}\n\n/**\n * Method to be called when binary data received from connection\n * after a BINARY_EVENT packet.\n *\n * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n * @return {null | Object} returns null if more binary data is expected or\n *   a reconstructed packet object if all buffers have been received.\n * @api private\n */\n\nBinaryReconstructor.prototype.takeBinaryData = function(binData) {\n  this.buffers.push(binData);\n  if (this.buffers.length == this.reconPack.attachments) { // done with buffer list\n    var packet = binary.reconstructPacket(this.reconPack, this.buffers);\n    this.finishedReconstruction();\n    return packet;\n  }\n  return null;\n};\n\n/**\n * Cleans up binary packet reconstruction variables.\n *\n * @api private\n */\n\nBinaryReconstructor.prototype.finishedReconstruction = function() {\n  this.reconPack = null;\n  this.buffers = [];\n};\n\nfunction error(data){\n  return {\n    type: exports.ERROR,\n    data: 'parser error'\n  };\n}\n\n},{\"./binary\":42,\"./is-buffer\":44,\"component-emitter\":8,\"debug\":9,\"isarray\":45,\"json3\":46}],44:[function(_dereq_,module,exports){\n(function (global){\n\nmodule.exports = isBuf;\n\n/**\n * Returns true if obj is a buffer or an arraybuffer.\n *\n * @api private\n */\n\nfunction isBuf(obj) {\n  return (global.Buffer && global.Buffer.isBuffer(obj)) ||\n         (global.ArrayBuffer && obj instanceof ArrayBuffer);\n}\n\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],45:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(36)\n},{}],46:[function(_dereq_,module,exports){\n/*! JSON v3.2.6 | http://bestiejs.github.io/json3 | Copyright 2012-2013, Kit Cambridge | http://kit.mit-license.org */\n;(function (window) {\n  // Convenience aliases.\n  var getClass = {}.toString, isProperty, forEach, undef;\n\n  // Detect the `define` function exposed by asynchronous module loaders. The\n  // strict `define` check is necessary for compatibility with `r.js`.\n  var isLoader = typeof define === \"function\" && define.amd;\n\n  // Detect native implementations.\n  var nativeJSON = typeof JSON == \"object\" && JSON;\n\n  // Set up the JSON 3 namespace, preferring the CommonJS `exports` object if\n  // available.\n  var JSON3 = typeof exports == \"object\" && exports && !exports.nodeType && exports;\n\n  if (JSON3 && nativeJSON) {\n    // Explicitly delegate to the native `stringify` and `parse`\n    // implementations in CommonJS environments.\n    JSON3.stringify = nativeJSON.stringify;\n    JSON3.parse = nativeJSON.parse;\n  } else {\n    // Export for web browsers, JavaScript engines, and asynchronous module\n    // loaders, using the global `JSON` object if available.\n    JSON3 = window.JSON = nativeJSON || {};\n  }\n\n  // Test the `Date#getUTC*` methods. Based on work by @Yaffle.\n  var isExtended = new Date(-3509827334573292);\n  try {\n    // The `getUTCFullYear`, `Month`, and `Date` methods return nonsensical\n    // results for certain dates in Opera >= 10.53.\n    isExtended = isExtended.getUTCFullYear() == -109252 && isExtended.getUTCMonth() === 0 && isExtended.getUTCDate() === 1 &&\n      // Safari < 2.0.2 stores the internal millisecond time value correctly,\n      // but clips the values returned by the date methods to the range of\n      // signed 32-bit integers ([-2 ** 31, 2 ** 31 - 1]).\n      isExtended.getUTCHours() == 10 && isExtended.getUTCMinutes() == 37 && isExtended.getUTCSeconds() == 6 && isExtended.getUTCMilliseconds() == 708;\n  } catch (exception) {}\n\n  // Internal: Determines whether the native `JSON.stringify` and `parse`\n  // implementations are spec-compliant. Based on work by Ken Snyder.\n  function has(name) {\n    if (has[name] !== undef) {\n      // Return cached feature test result.\n      return has[name];\n    }\n\n    var isSupported;\n    if (name == \"bug-string-char-index\") {\n      // IE <= 7 doesn't support accessing string characters using square\n      // bracket notation. IE 8 only supports this for primitives.\n      isSupported = \"a\"[0] != \"a\";\n    } else if (name == \"json\") {\n      // Indicates whether both `JSON.stringify` and `JSON.parse` are\n      // supported.\n      isSupported = has(\"json-stringify\") && has(\"json-parse\");\n    } else {\n      var value, serialized = '{\"a\":[1,true,false,null,\"\\\\u0000\\\\b\\\\n\\\\f\\\\r\\\\t\"]}';\n      // Test `JSON.stringify`.\n      if (name == \"json-stringify\") {\n        var stringify = JSON3.stringify, stringifySupported = typeof stringify == \"function\" && isExtended;\n        if (stringifySupported) {\n          // A test function object with a custom `toJSON` method.\n          (value = function () {\n            return 1;\n          }).toJSON = value;\n          try {\n            stringifySupported =\n              // Firefox 3.1b1 and b2 serialize string, number, and boolean\n              // primitives as object literals.\n              stringify(0) === \"0\" &&\n              // FF 3.1b1, b2, and JSON 2 serialize wrapped primitives as object\n              // literals.\n              stringify(new Number()) === \"0\" &&\n              stringify(new String()) == '\"\"' &&\n              // FF 3.1b1, 2 throw an error if the value is `null`, `undefined`, or\n              // does not define a canonical JSON representation (this applies to\n              // objects with `toJSON` properties as well, *unless* they are nested\n              // within an object or array).\n              stringify(getClass) === undef &&\n              // IE 8 serializes `undefined` as `\"undefined\"`. Safari <= 5.1.7 and\n              // FF 3.1b3 pass this test.\n              stringify(undef) === undef &&\n              // Safari <= 5.1.7 and FF 3.1b3 throw `Error`s and `TypeError`s,\n              // respectively, if the value is omitted entirely.\n              stringify() === undef &&\n              // FF 3.1b1, 2 throw an error if the given value is not a number,\n              // string, array, object, Boolean, or `null` literal. This applies to\n              // objects with custom `toJSON` methods as well, unless they are nested\n              // inside object or array literals. YUI 3.0.0b1 ignores custom `toJSON`\n              // methods entirely.\n              stringify(value) === \"1\" &&\n              stringify([value]) == \"[1]\" &&\n              // Prototype <= 1.6.1 serializes `[undefined]` as `\"[]\"` instead of\n              // `\"[null]\"`.\n              stringify([undef]) == \"[null]\" &&\n              // YUI 3.0.0b1 fails to serialize `null` literals.\n              stringify(null) == \"null\" &&\n              // FF 3.1b1, 2 halts serialization if an array contains a function:\n              // `[1, true, getClass, 1]` serializes as \"[1,true,],\". FF 3.1b3\n              // elides non-JSON values from objects and arrays, unless they\n              // define custom `toJSON` methods.\n              stringify([undef, getClass, null]) == \"[null,null,null]\" &&\n              // Simple serialization test. FF 3.1b1 uses Unicode escape sequences\n              // where character escape codes are expected (e.g., `\\b` => `\\u0008`).\n              stringify({ \"a\": [value, true, false, null, \"\\x00\\b\\n\\f\\r\\t\"] }) == serialized &&\n              // FF 3.1b1 and b2 ignore the `filter` and `width` arguments.\n              stringify(null, value) === \"1\" &&\n              stringify([1, 2], null, 1) == \"[\\n 1,\\n 2\\n]\" &&\n              // JSON 2, Prototype <= 1.7, and older WebKit builds incorrectly\n              // serialize extended years.\n              stringify(new Date(-8.64e15)) == '\"-271821-04-20T00:00:00.000Z\"' &&\n              // The milliseconds are optional in ES 5, but required in 5.1.\n              stringify(new Date(8.64e15)) == '\"+275760-09-13T00:00:00.000Z\"' &&\n              // Firefox <= 11.0 incorrectly serializes years prior to 0 as negative\n              // four-digit years instead of six-digit years. Credits: @Yaffle.\n              stringify(new Date(-621987552e5)) == '\"-000001-01-01T00:00:00.000Z\"' &&\n              // Safari <= 5.1.5 and Opera >= 10.53 incorrectly serialize millisecond\n              // values less than 1000. Credits: @Yaffle.\n              stringify(new Date(-1)) == '\"1969-12-31T23:59:59.999Z\"';\n          } catch (exception) {\n            stringifySupported = false;\n          }\n        }\n        isSupported = stringifySupported;\n      }\n      // Test `JSON.parse`.\n      if (name == \"json-parse\") {\n        var parse = JSON3.parse;\n        if (typeof parse == \"function\") {\n          try {\n            // FF 3.1b1, b2 will throw an exception if a bare literal is provided.\n            // Conforming implementations should also coerce the initial argument to\n            // a string prior to parsing.\n            if (parse(\"0\") === 0 && !parse(false)) {\n              // Simple parsing test.\n              value = parse(serialized);\n              var parseSupported = value[\"a\"].length == 5 && value[\"a\"][0] === 1;\n              if (parseSupported) {\n                try {\n                  // Safari <= 5.1.2 and FF 3.1b1 allow unescaped tabs in strings.\n                  parseSupported = !parse('\"\\t\"');\n                } catch (exception) {}\n                if (parseSupported) {\n                  try {\n                    // FF 4.0 and 4.0.1 allow leading `+` signs and leading\n                    // decimal points. FF 4.0, 4.0.1, and IE 9-10 also allow\n                    // certain octal literals.\n                    parseSupported = parse(\"01\") !== 1;\n                  } catch (exception) {}\n                }\n                if (parseSupported) {\n                  try {\n                    // FF 4.0, 4.0.1, and Rhino 1.7R3-R4 allow trailing decimal\n                    // points. These environments, along with FF 3.1b1 and 2,\n                    // also allow trailing commas in JSON objects and arrays.\n                    parseSupported = parse(\"1.\") !== 1;\n                  } catch (exception) {}\n                }\n              }\n            }\n          } catch (exception) {\n            parseSupported = false;\n          }\n        }\n        isSupported = parseSupported;\n      }\n    }\n    return has[name] = !!isSupported;\n  }\n\n  if (!has(\"json\")) {\n    // Common `[[Class]]` name aliases.\n    var functionClass = \"[object Function]\";\n    var dateClass = \"[object Date]\";\n    var numberClass = \"[object Number]\";\n    var stringClass = \"[object String]\";\n    var arrayClass = \"[object Array]\";\n    var booleanClass = \"[object Boolean]\";\n\n    // Detect incomplete support for accessing string characters by index.\n    var charIndexBuggy = has(\"bug-string-char-index\");\n\n    // Define additional utility methods if the `Date` methods are buggy.\n    if (!isExtended) {\n      var floor = Math.floor;\n      // A mapping between the months of the year and the number of days between\n      // January 1st and the first of the respective month.\n      var Months = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];\n      // Internal: Calculates the number of days between the Unix epoch and the\n      // first day of the given month.\n      var getDay = function (year, month) {\n        return Months[month] + 365 * (year - 1970) + floor((year - 1969 + (month = +(month > 1))) / 4) - floor((year - 1901 + month) / 100) + floor((year - 1601 + month) / 400);\n      };\n    }\n\n    // Internal: Determines if a property is a direct property of the given\n    // object. Delegates to the native `Object#hasOwnProperty` method.\n    if (!(isProperty = {}.hasOwnProperty)) {\n      isProperty = function (property) {\n        var members = {}, constructor;\n        if ((members.__proto__ = null, members.__proto__ = {\n          // The *proto* property cannot be set multiple times in recent\n          // versions of Firefox and SeaMonkey.\n          \"toString\": 1\n        }, members).toString != getClass) {\n          // Safari <= 2.0.3 doesn't implement `Object#hasOwnProperty`, but\n          // supports the mutable *proto* property.\n          isProperty = function (property) {\n            // Capture and break the object's prototype chain (see section 8.6.2\n            // of the ES 5.1 spec). The parenthesized expression prevents an\n            // unsafe transformation by the Closure Compiler.\n            var original = this.__proto__, result = property in (this.__proto__ = null, this);\n            // Restore the original prototype chain.\n            this.__proto__ = original;\n            return result;\n          };\n        } else {\n          // Capture a reference to the top-level `Object` constructor.\n          constructor = members.constructor;\n          // Use the `constructor` property to simulate `Object#hasOwnProperty` in\n          // other environments.\n          isProperty = function (property) {\n            var parent = (this.constructor || constructor).prototype;\n            return property in this && !(property in parent && this[property] === parent[property]);\n          };\n        }\n        members = null;\n        return isProperty.call(this, property);\n      };\n    }\n\n    // Internal: A set of primitive types used by `isHostType`.\n    var PrimitiveTypes = {\n      'boolean': 1,\n      'number': 1,\n      'string': 1,\n      'undefined': 1\n    };\n\n    // Internal: Determines if the given object `property` value is a\n    // non-primitive.\n    var isHostType = function (object, property) {\n      var type = typeof object[property];\n      return type == 'object' ? !!object[property] : !PrimitiveTypes[type];\n    };\n\n    // Internal: Normalizes the `for...in` iteration algorithm across\n    // environments. Each enumerated key is yielded to a `callback` function.\n    forEach = function (object, callback) {\n      var size = 0, Properties, members, property;\n\n      // Tests for bugs in the current environment's `for...in` algorithm. The\n      // `valueOf` property inherits the non-enumerable flag from\n      // `Object.prototype` in older versions of IE, Netscape, and Mozilla.\n      (Properties = function () {\n        this.valueOf = 0;\n      }).prototype.valueOf = 0;\n\n      // Iterate over a new instance of the `Properties` class.\n      members = new Properties();\n      for (property in members) {\n        // Ignore all properties inherited from `Object.prototype`.\n        if (isProperty.call(members, property)) {\n          size++;\n        }\n      }\n      Properties = members = null;\n\n      // Normalize the iteration algorithm.\n      if (!size) {\n        // A list of non-enumerable properties inherited from `Object.prototype`.\n        members = [\"valueOf\", \"toString\", \"toLocaleString\", \"propertyIsEnumerable\", \"isPrototypeOf\", \"hasOwnProperty\", \"constructor\"];\n        // IE <= 8, Mozilla 1.0, and Netscape 6.2 ignore shadowed non-enumerable\n        // properties.\n        forEach = function (object, callback) {\n          var isFunction = getClass.call(object) == functionClass, property, length;\n          var hasProperty = !isFunction && typeof object.constructor != 'function' && isHostType(object, 'hasOwnProperty') ? object.hasOwnProperty : isProperty;\n          for (property in object) {\n            // Gecko <= 1.0 enumerates the `prototype` property of functions under\n            // certain conditions; IE does not.\n            if (!(isFunction && property == \"prototype\") && hasProperty.call(object, property)) {\n              callback(property);\n            }\n          }\n          // Manually invoke the callback for each non-enumerable property.\n          for (length = members.length; property = members[--length]; hasProperty.call(object, property) && callback(property));\n        };\n      } else if (size == 2) {\n        // Safari <= 2.0.4 enumerates shadowed properties twice.\n        forEach = function (object, callback) {\n          // Create a set of iterated properties.\n          var members = {}, isFunction = getClass.call(object) == functionClass, property;\n          for (property in object) {\n            // Store each property name to prevent double enumeration. The\n            // `prototype` property of functions is not enumerated due to cross-\n            // environment inconsistencies.\n            if (!(isFunction && property == \"prototype\") && !isProperty.call(members, property) && (members[property] = 1) && isProperty.call(object, property)) {\n              callback(property);\n            }\n          }\n        };\n      } else {\n        // No bugs detected; use the standard `for...in` algorithm.\n        forEach = function (object, callback) {\n          var isFunction = getClass.call(object) == functionClass, property, isConstructor;\n          for (property in object) {\n            if (!(isFunction && property == \"prototype\") && isProperty.call(object, property) && !(isConstructor = property === \"constructor\")) {\n              callback(property);\n            }\n          }\n          // Manually invoke the callback for the `constructor` property due to\n          // cross-environment inconsistencies.\n          if (isConstructor || isProperty.call(object, (property = \"constructor\"))) {\n            callback(property);\n          }\n        };\n      }\n      return forEach(object, callback);\n    };\n\n    // Public: Serializes a JavaScript `value` as a JSON string. The optional\n    // `filter` argument may specify either a function that alters how object and\n    // array members are serialized, or an array of strings and numbers that\n    // indicates which properties should be serialized. The optional `width`\n    // argument may be either a string or number that specifies the indentation\n    // level of the output.\n    if (!has(\"json-stringify\")) {\n      // Internal: A map of control characters and their escaped equivalents.\n      var Escapes = {\n        92: \"\\\\\\\\\",\n        34: '\\\\\"',\n        8: \"\\\\b\",\n        12: \"\\\\f\",\n        10: \"\\\\n\",\n        13: \"\\\\r\",\n        9: \"\\\\t\"\n      };\n\n      // Internal: Converts `value` into a zero-padded string such that its\n      // length is at least equal to `width`. The `width` must be <= 6.\n      var leadingZeroes = \"000000\";\n      var toPaddedString = function (width, value) {\n        // The `|| 0` expression is necessary to work around a bug in\n        // Opera <= 7.54u2 where `0 == -0`, but `String(-0) !== \"0\"`.\n        return (leadingZeroes + (value || 0)).slice(-width);\n      };\n\n      // Internal: Double-quotes a string `value`, replacing all ASCII control\n      // characters (characters with code unit values between 0 and 31) with\n      // their escaped equivalents. This is an implementation of the\n      // `Quote(value)` operation defined in ES 5.1 section 15.12.3.\n      var unicodePrefix = \"\\\\u00\";\n      var quote = function (value) {\n        var result = '\"', index = 0, length = value.length, isLarge = length > 10 && charIndexBuggy, symbols;\n        if (isLarge) {\n          symbols = value.split(\"\");\n        }\n        for (; index < length; index++) {\n          var charCode = value.charCodeAt(index);\n          // If the character is a control character, append its Unicode or\n          // shorthand escape sequence; otherwise, append the character as-is.\n          switch (charCode) {\n            case 8: case 9: case 10: case 12: case 13: case 34: case 92:\n              result += Escapes[charCode];\n              break;\n            default:\n              if (charCode < 32) {\n                result += unicodePrefix + toPaddedString(2, charCode.toString(16));\n                break;\n              }\n              result += isLarge ? symbols[index] : charIndexBuggy ? value.charAt(index) : value[index];\n          }\n        }\n        return result + '\"';\n      };\n\n      // Internal: Recursively serializes an object. Implements the\n      // `Str(key, holder)`, `JO(value)`, and `JA(value)` operations.\n      var serialize = function (property, object, callback, properties, whitespace, indentation, stack) {\n        var value, className, year, month, date, time, hours, minutes, seconds, milliseconds, results, element, index, length, prefix, result;\n        try {\n          // Necessary for host object support.\n          value = object[property];\n        } catch (exception) {}\n        if (typeof value == \"object\" && value) {\n          className = getClass.call(value);\n          if (className == dateClass && !isProperty.call(value, \"toJSON\")) {\n            if (value > -1 / 0 && value < 1 / 0) {\n              // Dates are serialized according to the `Date#toJSON` method\n              // specified in ES 5.1 section 15.9.5.44. See section 15.9.1.15\n              // for the ISO 8601 date time string format.\n              if (getDay) {\n                // Manually compute the year, month, date, hours, minutes,\n                // seconds, and milliseconds if the `getUTC*` methods are\n                // buggy. Adapted from @Yaffle's `date-shim` project.\n                date = floor(value / 864e5);\n                for (year = floor(date / 365.2425) + 1970 - 1; getDay(year + 1, 0) <= date; year++);\n                for (month = floor((date - getDay(year, 0)) / 30.42); getDay(year, month + 1) <= date; month++);\n                date = 1 + date - getDay(year, month);\n                // The `time` value specifies the time within the day (see ES\n                // 5.1 section 15.9.1.2). The formula `(A % B + B) % B` is used\n                // to compute `A modulo B`, as the `%` operator does not\n                // correspond to the `modulo` operation for negative numbers.\n                time = (value % 864e5 + 864e5) % 864e5;\n                // The hours, minutes, seconds, and milliseconds are obtained by\n                // decomposing the time within the day. See section 15.9.1.10.\n                hours = floor(time / 36e5) % 24;\n                minutes = floor(time / 6e4) % 60;\n                seconds = floor(time / 1e3) % 60;\n                milliseconds = time % 1e3;\n              } else {\n                year = value.getUTCFullYear();\n                month = value.getUTCMonth();\n                date = value.getUTCDate();\n                hours = value.getUTCHours();\n                minutes = value.getUTCMinutes();\n                seconds = value.getUTCSeconds();\n                milliseconds = value.getUTCMilliseconds();\n              }\n              // Serialize extended years correctly.\n              value = (year <= 0 || year >= 1e4 ? (year < 0 ? \"-\" : \"+\") + toPaddedString(6, year < 0 ? -year : year) : toPaddedString(4, year)) +\n                \"-\" + toPaddedString(2, month + 1) + \"-\" + toPaddedString(2, date) +\n                // Months, dates, hours, minutes, and seconds should have two\n                // digits; milliseconds should have three.\n                \"T\" + toPaddedString(2, hours) + \":\" + toPaddedString(2, minutes) + \":\" + toPaddedString(2, seconds) +\n                // Milliseconds are optional in ES 5.0, but required in 5.1.\n                \".\" + toPaddedString(3, milliseconds) + \"Z\";\n            } else {\n              value = null;\n            }\n          } else if (typeof value.toJSON == \"function\" && ((className != numberClass && className != stringClass && className != arrayClass) || isProperty.call(value, \"toJSON\"))) {\n            // Prototype <= 1.6.1 adds non-standard `toJSON` methods to the\n            // `Number`, `String`, `Date`, and `Array` prototypes. JSON 3\n            // ignores all `toJSON` methods on these objects unless they are\n            // defined directly on an instance.\n            value = value.toJSON(property);\n          }\n        }\n        if (callback) {\n          // If a replacement function was provided, call it to obtain the value\n          // for serialization.\n          value = callback.call(object, property, value);\n        }\n        if (value === null) {\n          return \"null\";\n        }\n        className = getClass.call(value);\n        if (className == booleanClass) {\n          // Booleans are represented literally.\n          return \"\" + value;\n        } else if (className == numberClass) {\n          // JSON numbers must be finite. `Infinity` and `NaN` are serialized as\n          // `\"null\"`.\n          return value > -1 / 0 && value < 1 / 0 ? \"\" + value : \"null\";\n        } else if (className == stringClass) {\n          // Strings are double-quoted and escaped.\n          return quote(\"\" + value);\n        }\n        // Recursively serialize objects and arrays.\n        if (typeof value == \"object\") {\n          // Check for cyclic structures. This is a linear search; performance\n          // is inversely proportional to the number of unique nested objects.\n          for (length = stack.length; length--;) {\n            if (stack[length] === value) {\n              // Cyclic structures cannot be serialized by `JSON.stringify`.\n              throw TypeError();\n            }\n          }\n          // Add the object to the stack of traversed objects.\n          stack.push(value);\n          results = [];\n          // Save the current indentation level and indent one additional level.\n          prefix = indentation;\n          indentation += whitespace;\n          if (className == arrayClass) {\n            // Recursively serialize array elements.\n            for (index = 0, length = value.length; index < length; index++) {\n              element = serialize(index, value, callback, properties, whitespace, indentation, stack);\n              results.push(element === undef ? \"null\" : element);\n            }\n            result = results.length ? (whitespace ? \"[\\n\" + indentation + results.join(\",\\n\" + indentation) + \"\\n\" + prefix + \"]\" : (\"[\" + results.join(\",\") + \"]\")) : \"[]\";\n          } else {\n            // Recursively serialize object members. Members are selected from\n            // either a user-specified list of property names, or the object\n            // itself.\n            forEach(properties || value, function (property) {\n              var element = serialize(property, value, callback, properties, whitespace, indentation, stack);\n              if (element !== undef) {\n                // According to ES 5.1 section 15.12.3: \"If `gap` {whitespace}\n                // is not the empty string, let `member` {quote(property) + \":\"}\n                // be the concatenation of `member` and the `space` character.\"\n                // The \"`space` character\" refers to the literal space\n                // character, not the `space` {width} argument provided to\n                // `JSON.stringify`.\n                results.push(quote(property) + \":\" + (whitespace ? \" \" : \"\") + element);\n              }\n            });\n            result = results.length ? (whitespace ? \"{\\n\" + indentation + results.join(\",\\n\" + indentation) + \"\\n\" + prefix + \"}\" : (\"{\" + results.join(\",\") + \"}\")) : \"{}\";\n          }\n          // Remove the object from the traversed object stack.\n          stack.pop();\n          return result;\n        }\n      };\n\n      // Public: `JSON.stringify`. See ES 5.1 section 15.12.3.\n      JSON3.stringify = function (source, filter, width) {\n        var whitespace, callback, properties, className;\n        if (typeof filter == \"function\" || typeof filter == \"object\" && filter) {\n          if ((className = getClass.call(filter)) == functionClass) {\n            callback = filter;\n          } else if (className == arrayClass) {\n            // Convert the property names array into a makeshift set.\n            properties = {};\n            for (var index = 0, length = filter.length, value; index < length; value = filter[index++], ((className = getClass.call(value)), className == stringClass || className == numberClass) && (properties[value] = 1));\n          }\n        }\n        if (width) {\n          if ((className = getClass.call(width)) == numberClass) {\n            // Convert the `width` to an integer and create a string containing\n            // `width` number of space characters.\n            if ((width -= width % 1) > 0) {\n              for (whitespace = \"\", width > 10 && (width = 10); whitespace.length < width; whitespace += \" \");\n            }\n          } else if (className == stringClass) {\n            whitespace = width.length <= 10 ? width : width.slice(0, 10);\n          }\n        }\n        // Opera <= 7.54u2 discards the values associated with empty string keys\n        // (`\"\"`) only if they are used directly within an object member list\n        // (e.g., `!(\"\" in { \"\": 1})`).\n        return serialize(\"\", (value = {}, value[\"\"] = source, value), callback, properties, whitespace, \"\", []);\n      };\n    }\n\n    // Public: Parses a JSON source string.\n    if (!has(\"json-parse\")) {\n      var fromCharCode = String.fromCharCode;\n\n      // Internal: A map of escaped control characters and their unescaped\n      // equivalents.\n      var Unescapes = {\n        92: \"\\\\\",\n        34: '\"',\n        47: \"/\",\n        98: \"\\b\",\n        116: \"\\t\",\n        110: \"\\n\",\n        102: \"\\f\",\n        114: \"\\r\"\n      };\n\n      // Internal: Stores the parser state.\n      var Index, Source;\n\n      // Internal: Resets the parser state and throws a `SyntaxError`.\n      var abort = function() {\n        Index = Source = null;\n        throw SyntaxError();\n      };\n\n      // Internal: Returns the next token, or `\"$\"` if the parser has reached\n      // the end of the source string. A token may be a string, number, `null`\n      // literal, or Boolean literal.\n      var lex = function () {\n        var source = Source, length = source.length, value, begin, position, isSigned, charCode;\n        while (Index < length) {\n          charCode = source.charCodeAt(Index);\n          switch (charCode) {\n            case 9: case 10: case 13: case 32:\n              // Skip whitespace tokens, including tabs, carriage returns, line\n              // feeds, and space characters.\n              Index++;\n              break;\n            case 123: case 125: case 91: case 93: case 58: case 44:\n              // Parse a punctuator token (`{`, `}`, `[`, `]`, `:`, or `,`) at\n              // the current position.\n              value = charIndexBuggy ? source.charAt(Index) : source[Index];\n              Index++;\n              return value;\n            case 34:\n              // `\"` delimits a JSON string; advance to the next character and\n              // begin parsing the string. String tokens are prefixed with the\n              // sentinel `@` character to distinguish them from punctuators and\n              // end-of-string tokens.\n              for (value = \"@\", Index++; Index < length;) {\n                charCode = source.charCodeAt(Index);\n                if (charCode < 32) {\n                  // Unescaped ASCII control characters (those with a code unit\n                  // less than the space character) are not permitted.\n                  abort();\n                } else if (charCode == 92) {\n                  // A reverse solidus (`\\`) marks the beginning of an escaped\n                  // control character (including `\"`, `\\`, and `/`) or Unicode\n                  // escape sequence.\n                  charCode = source.charCodeAt(++Index);\n                  switch (charCode) {\n                    case 92: case 34: case 47: case 98: case 116: case 110: case 102: case 114:\n                      // Revive escaped control characters.\n                      value += Unescapes[charCode];\n                      Index++;\n                      break;\n                    case 117:\n                      // `\\u` marks the beginning of a Unicode escape sequence.\n                      // Advance to the first character and validate the\n                      // four-digit code point.\n                      begin = ++Index;\n                      for (position = Index + 4; Index < position; Index++) {\n                        charCode = source.charCodeAt(Index);\n                        // A valid sequence comprises four hexdigits (case-\n                        // insensitive) that form a single hexadecimal value.\n                        if (!(charCode >= 48 && charCode <= 57 || charCode >= 97 && charCode <= 102 || charCode >= 65 && charCode <= 70)) {\n                          // Invalid Unicode escape sequence.\n                          abort();\n                        }\n                      }\n                      // Revive the escaped character.\n                      value += fromCharCode(\"0x\" + source.slice(begin, Index));\n                      break;\n                    default:\n                      // Invalid escape sequence.\n                      abort();\n                  }\n                } else {\n                  if (charCode == 34) {\n                    // An unescaped double-quote character marks the end of the\n                    // string.\n                    break;\n                  }\n                  charCode = source.charCodeAt(Index);\n                  begin = Index;\n                  // Optimize for the common case where a string is valid.\n                  while (charCode >= 32 && charCode != 92 && charCode != 34) {\n                    charCode = source.charCodeAt(++Index);\n                  }\n                  // Append the string as-is.\n                  value += source.slice(begin, Index);\n                }\n              }\n              if (source.charCodeAt(Index) == 34) {\n                // Advance to the next character and return the revived string.\n                Index++;\n                return value;\n              }\n              // Unterminated string.\n              abort();\n            default:\n              // Parse numbers and literals.\n              begin = Index;\n              // Advance past the negative sign, if one is specified.\n              if (charCode == 45) {\n                isSigned = true;\n                charCode = source.charCodeAt(++Index);\n              }\n              // Parse an integer or floating-point value.\n              if (charCode >= 48 && charCode <= 57) {\n                // Leading zeroes are interpreted as octal literals.\n                if (charCode == 48 && ((charCode = source.charCodeAt(Index + 1)), charCode >= 48 && charCode <= 57)) {\n                  // Illegal octal literal.\n                  abort();\n                }\n                isSigned = false;\n                // Parse the integer component.\n                for (; Index < length && ((charCode = source.charCodeAt(Index)), charCode >= 48 && charCode <= 57); Index++);\n                // Floats cannot contain a leading decimal point; however, this\n                // case is already accounted for by the parser.\n                if (source.charCodeAt(Index) == 46) {\n                  position = ++Index;\n                  // Parse the decimal component.\n                  for (; position < length && ((charCode = source.charCodeAt(position)), charCode >= 48 && charCode <= 57); position++);\n                  if (position == Index) {\n                    // Illegal trailing decimal.\n                    abort();\n                  }\n                  Index = position;\n                }\n                // Parse exponents. The `e` denoting the exponent is\n                // case-insensitive.\n                charCode = source.charCodeAt(Index);\n                if (charCode == 101 || charCode == 69) {\n                  charCode = source.charCodeAt(++Index);\n                  // Skip past the sign following the exponent, if one is\n                  // specified.\n                  if (charCode == 43 || charCode == 45) {\n                    Index++;\n                  }\n                  // Parse the exponential component.\n                  for (position = Index; position < length && ((charCode = source.charCodeAt(position)), charCode >= 48 && charCode <= 57); position++);\n                  if (position == Index) {\n                    // Illegal empty exponent.\n                    abort();\n                  }\n                  Index = position;\n                }\n                // Coerce the parsed value to a JavaScript number.\n                return +source.slice(begin, Index);\n              }\n              // A negative sign may only precede numbers.\n              if (isSigned) {\n                abort();\n              }\n              // `true`, `false`, and `null` literals.\n              if (source.slice(Index, Index + 4) == \"true\") {\n                Index += 4;\n                return true;\n              } else if (source.slice(Index, Index + 5) == \"false\") {\n                Index += 5;\n                return false;\n              } else if (source.slice(Index, Index + 4) == \"null\") {\n                Index += 4;\n                return null;\n              }\n              // Unrecognized token.\n              abort();\n          }\n        }\n        // Return the sentinel `$` character if the parser has reached the end\n        // of the source string.\n        return \"$\";\n      };\n\n      // Internal: Parses a JSON `value` token.\n      var get = function (value) {\n        var results, hasMembers;\n        if (value == \"$\") {\n          // Unexpected end of input.\n          abort();\n        }\n        if (typeof value == \"string\") {\n          if ((charIndexBuggy ? value.charAt(0) : value[0]) == \"@\") {\n            // Remove the sentinel `@` character.\n            return value.slice(1);\n          }\n          // Parse object and array literals.\n          if (value == \"[\") {\n            // Parses a JSON array, returning a new JavaScript array.\n            results = [];\n            for (;; hasMembers || (hasMembers = true)) {\n              value = lex();\n              // A closing square bracket marks the end of the array literal.\n              if (value == \"]\") {\n                break;\n              }\n              // If the array literal contains elements, the current token\n              // should be a comma separating the previous element from the\n              // next.\n              if (hasMembers) {\n                if (value == \",\") {\n                  value = lex();\n                  if (value == \"]\") {\n                    // Unexpected trailing `,` in array literal.\n                    abort();\n                  }\n                } else {\n                  // A `,` must separate each array element.\n                  abort();\n                }\n              }\n              // Elisions and leading commas are not permitted.\n              if (value == \",\") {\n                abort();\n              }\n              results.push(get(value));\n            }\n            return results;\n          } else if (value == \"{\") {\n            // Parses a JSON object, returning a new JavaScript object.\n            results = {};\n            for (;; hasMembers || (hasMembers = true)) {\n              value = lex();\n              // A closing curly brace marks the end of the object literal.\n              if (value == \"}\") {\n                break;\n              }\n              // If the object literal contains members, the current token\n              // should be a comma separator.\n              if (hasMembers) {\n                if (value == \",\") {\n                  value = lex();\n                  if (value == \"}\") {\n                    // Unexpected trailing `,` in object literal.\n                    abort();\n                  }\n                } else {\n                  // A `,` must separate each object member.\n                  abort();\n                }\n              }\n              // Leading commas are not permitted, object property names must be\n              // double-quoted strings, and a `:` must separate each property\n              // name and value.\n              if (value == \",\" || typeof value != \"string\" || (charIndexBuggy ? value.charAt(0) : value[0]) != \"@\" || lex() != \":\") {\n                abort();\n              }\n              results[value.slice(1)] = get(lex());\n            }\n            return results;\n          }\n          // Unexpected token encountered.\n          abort();\n        }\n        return value;\n      };\n\n      // Internal: Updates a traversed object member.\n      var update = function(source, property, callback) {\n        var element = walk(source, property, callback);\n        if (element === undef) {\n          delete source[property];\n        } else {\n          source[property] = element;\n        }\n      };\n\n      // Internal: Recursively traverses a parsed JSON object, invoking the\n      // `callback` function for each value. This is an implementation of the\n      // `Walk(holder, name)` operation defined in ES 5.1 section 15.12.2.\n      var walk = function (source, property, callback) {\n        var value = source[property], length;\n        if (typeof value == \"object\" && value) {\n          // `forEach` can't be used to traverse an array in Opera <= 8.54\n          // because its `Object#hasOwnProperty` implementation returns `false`\n          // for array indices (e.g., `![1, 2, 3].hasOwnProperty(\"0\")`).\n          if (getClass.call(value) == arrayClass) {\n            for (length = value.length; length--;) {\n              update(value, length, callback);\n            }\n          } else {\n            forEach(value, function (property) {\n              update(value, property, callback);\n            });\n          }\n        }\n        return callback.call(source, property, value);\n      };\n\n      // Public: `JSON.parse`. See ES 5.1 section 15.12.2.\n      JSON3.parse = function (source, callback) {\n        var result, value;\n        Index = 0;\n        Source = \"\" + source;\n        result = get(lex());\n        // If a JSON string contains multiple tokens, it is invalid.\n        if (lex() != \"$\") {\n          abort();\n        }\n        // Reset the parser state.\n        Index = Source = null;\n        return callback && getClass.call(callback) == functionClass ? walk((value = {}, value[\"\"] = result, value), \"\", callback) : result;\n      };\n    }\n  }\n\n  // Export for asynchronous module loaders.\n  if (isLoader) {\n    define(function () {\n      return JSON3;\n    });\n  }\n}(this));\n\n},{}],47:[function(_dereq_,module,exports){\nmodule.exports = toArray\n\nfunction toArray(list, index) {\n    var array = []\n\n    index = index || 0\n\n    for (var i = index || 0; i < list.length; i++) {\n        array[i - index] = list[i]\n    }\n\n    return array\n}\n\n},{}]},{},[1])\n(1)\n});\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}]},{},[2]);\n"],"sourceRoot":"/source/"}